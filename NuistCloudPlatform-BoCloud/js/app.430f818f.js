(function(){var e={2022:function(e,t,a){"use strict";var s=a(8935),i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.$route.meta.show?a("el-container",{staticStyle:{height:"100%"}},[e.$route.meta.show?a("el-header",[a("Header")],1):e._e(),a("el-container",[e.$route.meta.show?a("el-aside",{attrs:{width:"200px"}},[a("SideBar")],1):e._e(),a("el-container",[a("el-main",[a("router-view")],1),e.$route.meta.show?a("el-footer",[a("Footer")],1):e._e()],1)],1)],1):e._e(),e.$route.meta.show?e._e():a("Login")],1)},l=[],o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-row",[s("el-menu",{attrs:{mode:"horizontal","background-color":"#ADB6CA","text-color":"black"}},[s("el-col",{attrs:{span:20}},[s("div",{staticStyle:{"text-align":"center",height:"60px"}},[s("img",{staticStyle:{height:"60px",width:"210px","margin-left":"10px",float:"left"},attrs:{src:a(7570)}}),s("span",{staticClass:"font"},[e._v("米级国产卫星数据存算共享云平台 ")])])]),s("el-col",{attrs:{span:1}},[s("div",{staticStyle:{"text-align":"center",height:"60px","font-size":"16px"}},[e._v(" "+e._s(e.username)+" ")])]),s("el-col",{staticStyle:{width:"100px"}},[s("el-submenu",{staticStyle:{padding:"0px"},attrs:{index:"1"}},[s("el-menu-item",{staticStyle:{padding:"0px"},attrs:{index:"1"},on:{click:function(t){e.passwordDialogVisible=!0}}},[s("i",{staticClass:"el-icon-edit",staticStyle:{color:"black"}},[e._v("修改密码")])]),s("template",{slot:"title"},[s("el-avatar",{attrs:{src:"https://cube.elemecdn.com/0/88/03b0d39583f48206768a7534e55bcpng.png"}})],1)],2)],1),s("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[s("el-menu-item",{staticClass:"size",staticStyle:{padding:"0px","font-size":"16px"},attrs:{index:"2"},on:{click:e.logout}},[e._v("Logout")])],1)],1),s("el-dialog",{staticClass:"dialogClass",attrs:{title:"修改密码",visible:e.passwordDialogVisible,width:"400px","before-close":e.handleClose},on:{"update:visible":function(t){e.passwordDialogVisible=t}}},[s("el-form",{ref:"passwdForm",staticStyle:{margin:"0px",padding:"0px"},attrs:{"label-position":"right","label-width":"100px",rules:e.passwdRules,model:e.passwd}},[s("el-col",[s("el-form-item",{attrs:{label:"当前密码",prop:"oldPassword"}},[s("el-input",{staticStyle:{width:"270px"},attrs:{placeholder:"请输入当前密码",size:"small","show-password":""},on:{blur:function(t){return e.verifyPasswd()}},model:{value:e.passwd.oldPassword,callback:function(t){e.$set(e.passwd,"oldPassword",t)},expression:"passwd.oldPassword"}})],1)],1),s("el-col",[s("el-form-item",{attrs:{label:"新密码",prop:"newPassword1"}},[s("el-input",{staticStyle:{width:"270px"},attrs:{"show-password":"",placeholder:"请输入新密码",size:"small"},model:{value:e.passwd.newPassword1,callback:function(t){e.$set(e.passwd,"newPassword1",t)},expression:"passwd.newPassword1"}})],1)],1),s("el-col",[s("el-form-item",{attrs:{label:"二次确认",prop:"newPassword2"}},[s("el-input",{staticStyle:{width:"270px"},attrs:{"show-password":"",placeholder:"请再次输入新密码",size:"small"},model:{value:e.passwd.newPassword2,callback:function(t){e.$set(e.passwd,"newPassword2",t)},expression:"passwd.newPassword2"}})],1)],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closePasswd()}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.updatePasswd()}}},[e._v("确 定")])],1)],1)],1)},r=[],n=(a(1703),a(6166)),c=a.n(n),d=a(9879),m=a.n(d);const p=c().create({baseURL:"/api",timeout:5e4});p.interceptors.request.use((e=>(m().start(),e.headers["token"]=localStorage.getItem("token"),e.headers["refreshToken"]=localStorage.getItem("refreshToken"),e.headers["modelId"]=1,e.headers["systemId"]=1,e))),p.interceptors.response.use((e=>(m().done(),e.data.token&&localStorage.setItem("token",e.data.token),201==e.data.code&&(localStorage.clear(),s["default"].$router.push({name:"login"})),e.data)),(e=>(m().done(),Promise.reject(new Error("fail")))));var u=p;const h=c().create({baseURL:"/ide",timeout:5e4});h.interceptors.request.use((e=>(m().start(),e))),h.interceptors.response.use((e=>(m().done(),e.data.token&&localStorage.setItem("token",e.data.token),201==e.data.code&&(localStorage.clear(),vue.$router.push({name:"login"})),e.data)),(e=>(m().done(),Promise.reject(new Error("fail")))));var g=h,f=a(7421),w=a.n(f);const b=({name:e,password:t})=>g({url:"/node-manager/user/login",method:"POST",data:w().stringify({name:e,password:t})}),v=()=>g({url:"/node-manager/workspace/start",method:"POST",withCredentials:!0}),_=()=>g({url:"/node-manager/workspace/stop",method:"POST",withCredentials:!0}),y=()=>g({url:"/node-manager/workspace",method:"POST",withCredentials:!0}),I=e=>u({url:"/paas-web/upmstreeapi/login",method:"POST",data:e}),x=e=>u({url:"/paas-web/upmstreeapi/accessToken",method:"get",params:{code:e}}),S=e=>u({url:"/paas-web/bocapi/volcano/v3.3/vcJob/list",method:"post",data:e}),k=(e,t)=>u({url:"/paas-web/bocapi/volcano/v3.3/vcJob/delete",method:"post",data:{clusterId:e,vcJobId:t}}),C=(e,t,a)=>u({url:"/paas-web/bocapi/dataBcc/list",method:"get",params:{type:e,self:t,isPlatform:a}}),P=(e,t,a,s)=>u({url:"/paas-web/bocapi/fileBcc/pageList",method:"get",params:{dataId:e,filePath:t,current:a,size:s}}),N=(e,t,a,s)=>u({url:"/paas-web/bocapi/dataBcc/add",method:"post",data:{name:e,remark:t,storageId:a,type:s}}),L=e=>u({url:`/paas-web/bocapi/dataBcc/${e}`,method:"delete"}),F=(e,t,a,s,i)=>u({url:"/paas-web/bocapi/dataBcc/update",method:"put",data:{id:e,name:t,remark:a,storageId:s,type:i}}),z=(e,t,a,s)=>u({url:"/paas-web/bocapi/fileBcc/rename",method:"get",params:{dataId:e,filePath:t,fileName:a,newName:s}}),T=(e,t,a,s)=>u({url:"/paas-web/bocapi/fileBcc/createFolder",method:"get",params:{dataId:e,filePath:t,folderName:a,desc:s}}),$=(e,t,a,s)=>u({url:"/paas-web/bocapi/fileBcc/download",method:"get",params:{fileName:e,dataId:t,filePath:a,fileType:1}}),E=e=>u({url:"/paas-web/bocapi/fileBcc/status",method:"get",params:{filePath:e}}),D=(e,t,a)=>u({url:"/paas-web/bocapi/fileBcc/deleteFiles",method:"post",data:{dataId:e,fileList:t,filePath:a}}),J=(e,t,a,s,i,l,o,r)=>u({url:"/paas-web/bocapi/fileBcc/upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:{chunkNumber:"1",chunkSize:"2048000",currentChunkSize:e,totalSize:t,identifier:a,filename:s,relativePath:i,totalChunks:"1",filePath:l,rootPath:"/opt/bcc/storage1/",dataId:o,file:r}}),O=(e,t,a,s,i,l)=>u({url:"/paas-web/bocapi/image/v2.3/queryRegImageList",method:"post",data:{currPageNum:e,imageCatalogId:t,imageCatalogType:a,imageName:s,pageSize:i,warehouseId:l}}),R=e=>u({url:"/paas-web/bocapi/image/v2.3/queryRegImageVersionList",method:"post",data:{currPageNum:1,imageName:e,pageSize:1e3}}),V=e=>u({url:"/paas-web/bocapi/warehouse/v2.3/overview",method:"post",data:{envId:e||1}}),A=(e,t,a,s,i,l)=>u({url:"/paas-web/bocapi/volcano/v3.3/pod/info1",method:"post",data:{clusterId:e,currPageNum:t,nodeName:a,pageSize:s,podName:i,queueName:"default",vcJobName:l}}),j=e=>u({url:"/paas-web/bocapi/image/v2.3/queryRegImages",method:"post",data:{imageCatalogId:e}}),M=()=>u({url:"/paas-web/bocapi/volcano/v3.3/queue/list",method:"post",data:{currPageNum:1,envId:1,pageSize:1e3}}),U=e=>u({url:"/paas-web/bocapi/warehouse/v2.3/getList",method:"post",data:{clusterId:e,envId:1,types:["Registry","Harbor","Artifactory"]}}),q=e=>u({url:"/paas-web/bocapi/imageCatalog/v3.0/list",method:"post",data:{envId:1,warehouseId:e,withPublic:!0}}),B=e=>u({url:"/paas-web/bocapi/image/v2.3/queryRegImageVersionList",method:"post",data:{imageName:e}}),G=e=>u({url:"/paas-web/bocapi/dataBcc/list",method:"get",params:{type:e,self:0}}),H=({target:e,vcJob:t,tasks:a})=>u({url:"/paas-web/bocapi/volcano/v3.3/vcJob/create",method:"post",data:{target:e,vcJob:t,tasks:a}}),Z=(e,t)=>u({url:"/paas-web/bocapi/volcano/v3.3/vcJob/start",method:"post",data:{clusterId:e,vcJobId:t}}),W=e=>u({url:"/paas-web/upmstreeapi/login/password",method:"get",params:{oldPassword:e}}),X=e=>u({url:"/paas-web/upmstreeapi/login/password",method:"PUT",data:e}),K=e=>u({url:"/paas-web/upmstreeapi/core/account",method:"put",data:e});var Q=a(4665),Y={name:"Header",data(){var e=(e,t,a)=>""===this.passwd.newPassword2?a(new Error("请再次输入密码")):this.passwd.newPassword2!=this.passwd.newPassword1?a(new Error("两次输入密码不一致!")):a();return{passwordDialogVisible:!1,passwd:{oldPassword:"",newPassword1:"",newPassword2:""},passwdRules:{oldPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword1:[{required:!0,message:"请输入新密码",trigger:"blur"}],newPassword2:[{required:!0,validator:e,trigger:"change"}]}}},computed:{...(0,Q.rn)("User",["userInfo"]),username(){return localStorage.getItem("user")}},methods:{logout(){localStorage.clear(),this.$router.push({name:"login"})},async verifyPasswd(){let e=a(9719).Base64;if(""!=this.passwd.oldPassword){let t=await W(e.encode(this.passwd.oldPassword));!0!==t.data&&(this.$message.error("原密码错误!"),this.passwd.oldPassword="")}},handleClose(e){let t=this;this.$confirm("确认关闭？").then((a=>{t.passwd.oldPassword="",t.passwd.newPassword1="",t.passwd.newPassword2="",e()})).catch((e=>{}))},closePasswd(){this.passwordDialogVisible=!1,this.passwd.oldPassword="",this.passwd.newPassword1="",this.passwd.newPassword2=""},updatePasswd(){this.passwordDialogVisible=!1;let e=this;this.$refs["passwdForm"].validate((async t=>{if(!t)return!1;{let t=a(9719).Base64;await X({password:t.encode(this.passwd.newPassword1),oldPassword:t.encode(this.passwd.oldPassword),id:this.userInfo.id});e.logout()}}))}}},ee=Y,te=a(1001),ae=(0,te.Z)(ee,o,r,!1,null,null,null),se=ae.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",[a("el-col",{attrs:{span:24}},[a("el-menu",{attrs:{"default-active":"1-1"}},[a("el-submenu",{attrs:{index:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-cpu"}),a("span",{staticClass:"size"},[e._v("我的作业")])]),a("el-menu-item",{attrs:{index:"1-1"},on:{click:function(t){return e.toJob()}}},[a("span",{staticClass:"subsize",attrs:{slot:"title"},slot:"title"},[e._v("作业列表")])]),a("el-menu-item",{attrs:{index:"1-2"},on:{click:function(t){return e.goStandardJob()}}},[a("span",{staticClass:"subsize",attrs:{slot:"title"},slot:"title"},[e._v("新建作业")])])],2),a("el-submenu",{attrs:{index:"2"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-takeaway-box"}),a("span",{staticClass:"size"},[e._v("模型管理")])]),a("el-menu-item",{attrs:{index:"2-1"},on:{click:e.toData}},[a("span",{staticClass:"subsize",attrs:{slot:"title"},slot:"title"},[e._v("训练模型")])]),a("el-menu-item",{attrs:{index:"2-2"},on:{click:e.toResultData}},[a("span",{staticClass:"subsize",attrs:{slot:"title"},slot:"title"},[e._v("测试模型")])])],2),a("div",{on:{click:e.toImages}},[a("el-menu-item",{attrs:{index:"3"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-copy-document"}),a("span",{staticClass:"size"},[e._v("镜像仓库")])])],2)],1),a("div",{on:{click:e.toIDE}},[a("el-menu-item",{attrs:{index:"4"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-edit-outline"}),a("span",{staticClass:"size"},[e._v("在线IDE")])])],2)],1),a("div",{on:{click:e.toUserInfo}},[a("el-menu-item",{attrs:{index:"5"}},[a("template",{slot:"title"},[a("i",{staticClass:"el-icon-user"}),a("span",{staticClass:"size"},[e._v("个人中心")])])],2)],1)],1)],1)],1)},le=[],oe=a(4549),re=a.n(oe),ne={name:"SideBar",data(){return{}},methods:{toJob(){this.$router.push({name:"job"})},goStandardJob(){this.$router.push({name:"standardjob"})},toData(){this.$router.push({name:"data"})},toResultData(){this.$router.push({name:"resultdata"})},toImages(){this.$router.push({name:"images"})},toIDE(){this.$router.push({name:"ide"})},toUserInfo(){this.$router.push({name:"userinfo"})}}},ce=ne,de=(0,te.Z)(ce,ie,le,!1,null,"dfb788b8",null),me=de.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"center","font-size":"16px"}},[e._v(" Copyright©2022 南京信息工程大学 ")])},ue=[],he={name:"Footer",data(){return{}},methods:{}},ge=he,fe=(0,te.Z)(ge,pe,ue,!1,null,"5ded1e22",null),we=fe.exports,be=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",[s("el-menu",{attrs:{mode:"horizontal","background-color":"#ADB6CA","text-color":"black"}},[s("el-col",{attrs:{span:20}},[s("div",{staticStyle:{"text-align":"center",height:"60px"}},[s("img",{staticStyle:{height:"60px",width:"210px","margin-left":"10px",float:"left"},attrs:{src:a(7570)}}),s("div",{staticClass:"font",staticStyle:{"padding-top":"13px"}},[e._v(" 米级国产卫星数据存算共享云平台 ")])])])],1)],1),s("div",{staticClass:"container"},[s("div",{staticClass:"forms-container"},[s("div",{staticClass:"signin-signup"},[s("form",{staticClass:"sign-in-form",attrs:{action:"#"}},[s("h2",{staticClass:"title"},[e._v("登录")]),s("div",{staticClass:"input-field"},[s("i",{staticClass:"fas fa-user"}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.username,expression:"user.username"}],attrs:{type:"text",placeholder:"用户名"},domProps:{value:e.user.username},on:{input:function(t){t.target.composing||e.$set(e.user,"username",t.target.value)}}})]),s("div",{staticClass:"input-field"},[s("i",{staticClass:"fas fa-lock"}),s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],attrs:{type:"password",placeholder:"密码"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}})]),s("div",{ref:"dragDiv",staticClass:"drag"},[s("div",{staticClass:"drag_bg"}),s("div",{staticClass:"drag_text"},[e._v(e._s(e.confirmWords))]),s("div",{ref:"moveDiv",staticClass:"handler handler_bg",class:{handler_ok_bg:e.confirmSuccess},staticStyle:{position:"absolute",top:"0px",left:"0px"},on:{mousedown:function(t){return e.mousedownFn(t)}}})]),s("input",{staticClass:"btn solid",attrs:{type:"submit",value:"立即登录"},on:{click:e.doLogin}})])])]),e._m(0)]),e._m(1)],1)},ve=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panels-container"},[s("div",{staticClass:"panel left-panel"},[s("div",{staticClass:"content"},[s("h3",[e._v("欢迎使用")]),s("h5",{staticStyle:{"margin-top":"10px","font-size":"16px"}},[e._v(" 米级国产卫星数据存算共享云平台 ")])]),s("img",{staticClass:"image",attrs:{src:a(3630),alt:""}})])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"center","font-size":"16px",height:"60px","background-color":"#b6c0cf"}},[a("p",{staticStyle:{"padding-top":"22px"}},[e._v("Copyright©2022 南京信息工程大学")])])}],_e={name:"Login",data(){return{user:{username:"",password:""},beginClientX:0,mouseMoveStata:!1,maxwidth:"",confirmWords:"拖动滑块验证",confirmSuccess:!1}},computed:{...(0,Q.rn)("User",["userInfo"])},methods:{async doLogin(){if(1==this.confirmSuccess){let e=a(9719).Base64;if(localStorage.getItem("token"))this.$router.push({name:"job"});else{let t={userName:this.user.username,password:e.encode(this.user.password),typeConfigId:0,clientId:"be2030fc2aa0416d8c9dcaa5081fb1ad"},a=await I(t);if("200"==a.code){this.$store.dispatch("User/getUserInfo",a.data);let e=await x(a.data.code);"200"==e.code&&(this.$store.dispatch("User/getUserToken",{token:e.data.token,refreshToken:e.data.refreshToken}),this.$message({message:"登陆成功",type:"success"}),localStorage.setItem("user",this.user.username),this.$router.push({name:"job"}))}else this.$message.error("登录失败")}}else this.$message.warning("请先滑动验证!")},mousedownFn:function(e){this.confirmSuccess||(e.preventDefault&&e.preventDefault(),this.mouseMoveStata=!0,this.beginClientX=e.clientX)},successFunction(){this.confirmSuccess=!0,this.confirmWords="验证通过",window.addEventListener?(document.getElementsByTagName("html")[0].removeEventListener("mousemove",this.mouseMoveFn),document.getElementsByTagName("html")[0].removeEventListener("mouseup",this.moseUpFn)):document.getElementsByTagName("html")[0].removeEventListener("mouseup",(()=>{})),document.getElementsByClassName("drag_text")[0].style.color="#fff",document.getElementsByClassName("handler")[0].style.left=this.maxwidth+"px",document.getElementsByClassName("drag_bg")[0].style.width=this.maxwidth+"px"},mouseMoveFn(e){if(this.mouseMoveStata){let t=e.clientX-this.beginClientX;t>0&&t<=this.maxwidth?(document.getElementsByClassName("handler")[0].style.left=t+"px",document.getElementsByClassName("drag_bg")[0].style.width=t+"px"):t>this.maxwidth&&this.successFunction()}},moseUpFn(e){this.mouseMoveStata=!1;var t=e.clientX-this.beginClientX;t<this.maxwidth&&(document.getElementsByClassName("handler")[0].style.left="0px",document.getElementsByClassName("drag_bg")[0].style.width="0px")}},mounted(){this.maxwidth=this.$refs.dragDiv.clientWidth-this.$refs.moveDiv.clientWidth,document.getElementsByTagName("html")[0].addEventListener("mousemove",this.mouseMoveFn),document.getElementsByTagName("html")[0].addEventListener("mouseup",this.moseUpFn)}},ye=_e,Ie=(0,te.Z)(ye,be,ve,!1,null,"602e2a7e",null),xe=Ie.exports,Se={name:"App",components:{Header:se,SideBar:me,Footer:we,Login:xe},mounted(){}},ke=Se,Ce=(0,te.Z)(ke,i,l,!1,null,"67ffb6eb",null),Pe=Ce.exports;const Ne={async getJobList({commit:e},t){let a=await S(t);!0===a.success&&(e("JOBLIST",a.rows),e("PAGENUM",a.currPageNum),e("PAGESIZE",a.pageSize),e("TOTALPAGE",a.pageCount))},getJobInfoList({commit:e},{currPageNum:t,pageCount:a,pageSize:s,jobInfoList:i}){e("JOBINFOCURRENTPAGENUM",t),e("JOBINFOPAGECOUNT",a),e("JOBINFOPAGESIZE",s),e("JOBINFOLIST",i)}},Le={JOBLIST(e,t){e.joblist=t},PAGENUM(e,t){e.pagenum=t},PAGESIZE(e,t){e.pagesize=t},TOTALPAGE(e,t){e.totalpage=t},JOBINFOCURRENTPAGENUM(e,t){e.jobInfoCurrPageNum=t},JOBINFOPAGECOUNT(e,t){e.jobInfoPageCount=t},JOBINFOPAGESIZE(e,t){e.jobInfoPageSize=t},JOBINFOLIST(e,t){e.jobInfoList=t}},Fe={jobInfoCurrPageNum:"",jobInfoPageCount:"",jobInfoPageSize:"",joblist:[],pagesize:"",pagenum:"",totalpage:"",jobInfoList:[]},ze={};var Te={namespaced:!0,actions:Ne,mutations:Le,state:Fe,getters:ze};const $e={getParentFileList({commit:e},t){e("PARENTFILELIST",t)},async getChildFileList({commit:e},t){let a=await P(t.dataId,t.filePath,t.current,t.size);200==a.code&&(e("PAGENUM",a.data.current),e("FILEPATH",a.data.filePath),e("CHILDFILELIST",a.data.fileList),e("PAGESIZE",a.data.size),e("TOATLRECORD",a.data.total))}},Ee={PARENTFILELIST(e,t){e.parentFileList=t},PAGENUM(e,t){e.pageNum=t},FILEPATH(e,t){e.filePath=t},CHILDFILELIST(e,t){e.childFileList=t},PAGESIZE(e,t){e.pageSize=t},TOATLRECORD(e,t){e.totalRecord=t}},De={parentFileList:[],childFileList:[],pageNum:"",filePath:"",pageSize:"",totalRecord:""},Je={};var Oe={namespaced:!0,actions:$e,mutations:Ee,state:De,getters:Je};const Re={getParentFileList({commit:e},t){e("PARENTFILELIST",t)},async getChildFileList({commit:e},t){let a=await P(t.dataId,t.filePath,t.current,t.size);200==a.code&&(e("PAGENUM",a.data.current),e("FILEPATH",a.data.filePath),e("CHILDFILELIST",a.data.fileList),e("PAGESIZE",a.data.size),e("TOATLRECORD",a.data.total))}},Ve={PARENTFILELIST(e,t){e.parentFileList=t},PAGENUM(e,t){e.pageNum=t},FILEPATH(e,t){e.filePath=t},CHILDFILELIST(e,t){e.childFileList=t},PAGESIZE(e,t){e.pageSize=t},TOATLRECORD(e,t){e.totalRecord=t}},Ae={parentFileList:[],childFileList:[],pageNum:"",filePath:"",pageSize:"",totalRecord:""},je={};var Me={namespaced:!0,actions:Re,mutations:Ve,state:Ae,getters:je};const Ue={async getUserInfo({commit:e},t){localStorage.setItem("userInfo",JSON.stringify(t)),e("USERINFO",t)},async getUserToken({commit:e},{token:t,refreshToken:a}){e("REFRESHTOKEN",a),e("TOKEN",t),localStorage.setItem("refreshToken",a),localStorage.setItem("token",t)}},qe={USERINFO(e,t){e.userInfo=t},REFRESHTOKEN(e,t){e.refreshToken=t},TOKEN(e,t){e.token=t}},Be={userInfo:{},refreshToken:"",token:""},Ge={};var He={namespaced:!0,actions:Ue,mutations:qe,state:Be,getters:Ge};const Ze={getImageOverview({commit:e},{warehouseId:t,warehouseName:a,imageCatalogs:s}){e("WAREHOUSEID",t),e("WAREHOUSENAME",a),e("IMAGECATALOGS",s)},getImageList({commit:e},{imageList:t,totalCount:a,currPageNum:s}){e("IMAGELIST",t),e("TOTALCOUNT",a),e("CURRPAGENUM",s)},getImageVersionList({commit:e},t){e("IMAGEVERSIONLIST",t)}},We={WAREHOUSEID(e,t){e.warehouseId=t},WAREHOUSENAME(e,t){e.warehouseName=t},IMAGECATALOGS(e,t){e.imageCatalogs=t},IMAGELIST(e,t){e.imageList=t},TOTALCOUNT(e,t){e.totalCount=t},CURRPAGENUM(e,t){e.currPageNum=t},IMAGEVERSIONLIST(e,t){e.imageVersionList=t}},Xe={warehouseId:0,warehouseName:"",imageCatalogs:[],imageList:[],pageSize:10,totalCount:"",imageVersionList:[]},Ke={};var Qe={namespaced:!0,actions:Ze,mutations:We,state:Xe,getters:Ke};const Ye={getQueueList({commit:e},t){e("QUEUELIST",t)},getWareHouseList({commit:e},t){e("WAREHOUSELIST",t)},getWareHouseImageList({commit:e},t){e("IMAGECATALODLIST",t)},getImage({commit:e},t){e("IMAGELIST",t)},getImageVersion({commit:e},t){e("IMAGEVERSIONLIST",t)},getDataSet({commit:e},t){e("DATA",t)}},et={DATA(e,t){e.data=t},QUEUELIST(e,t){e.queueList=t},WAREHOUSELIST(e,t){e.warehouseList=t},IMAGECATALODLIST(e,t){e.imageCatalogList=t},IMAGELIST(e,t){e.imageList=t},IMAGEVERSIONLIST(e,t){e.imageVersionList=t}},tt={queueList:[],warehouseList:[],imageCatalogList:[{catalogId:0},{catalogId:0}],imageList:[],imageVersionList:[],data:[]},at={};var st={namespaced:!0,actions:Ye,mutations:et,state:tt,getters:at};s["default"].use(Q.ZP);var it=new Q.ZP.Store({modules:{Job:Te,File:Oe,User:He,Image:Qe,ResultFile:Me,CreateJob:st}}),lt=a(2809),ot=a(9483),rt=a(8522),nt=(a(6733),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("我的作业")]),a("el-breadcrumb-item",[e._v("作业列表")])],1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticClass:"el-icon-circle-plus-outline",staticStyle:{"margin-top":"10px","margin-left":"10px","padding-right":"8px","padding-top":"8px","padding-bottom":"8px","padding-left":"8px"},attrs:{size:"mini",type:"primary"},on:{click:e.toCreateJob}},[e._v("新建作业")])],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-table",{staticStyle:{width:"100%","margin-top":"10px","margin-left":"10px"},attrs:{"row-style":{height:"40px"},"cell-style":{padding:"0px"},data:e.formatedJobList,border:!0,"row-class-name":e.tableRowClassName,"max-height":"700"}},[a("el-table-column",{attrs:{prop:"vcJobCnName",label:"任务名","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.toJobInfo(t.$index)}}},[e._v(e._s(t.row.vcJobCnName))])]}}])}),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"taskTotal",label:"总任务数",width:"100","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"taskCompleted",label:"运行完成数",width:"120","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"taskPending",label:"排队中",width:"80","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"cpuUsed",label:"cpu使用量",width:"120","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"memUsed",label:"内存使用量",width:"120"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["Terminated"==t.row.status?a("el-tag",{attrs:{size:"small",type:"danger"}},[e._v("已终止")]):e._e(),"Pending"==t.row.status?a("el-tag",{attrs:{size:"small",type:"warning"}},[e._v("排队中")]):e._e(),"Completed"==t.row.status?a("el-tag",{attrs:{size:"small",type:"success"}},[e._v("已完成")]):e._e(),"No_Running"==t.row.status?a("el-tag",{attrs:{size:"small",type:"warning"}},[e._v("未开始")]):e._e(),"Running"==t.row.status?a("el-tag",{attrs:{size:"small"}},[e._v("运行中")]):e._e()]}}])}),a("el-table-column",{attrs:{label:"操作",width:"160",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["No_Running"==t.row.status?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.startJob(t.row.clusterId,t.row.vcJobId)}}},[e._v("启动")]):e._e(),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteJob(t.row.clusterId,t.row.vcJobId)}}},[e._v("删除")])]}}])})],1)],1),a("el-col",{staticStyle:{"text-align":"center"}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-pagination",{attrs:{background:!0,"page-sizes":[10,20,30],"page-size":e.page,layout:"prev, pager, next,sizes","page-count":Number(e.totalpage)},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1)}),ct=[];const dt=function(e){var t=new Date(e).toJSON();return new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")};var mt={name:"Job",data(){return{secondBread:"标准作业",page:8}},computed:{...(0,Q.rn)("Job",["joblist","pagesize","pagenum","totalpage"]),formatedJobList(){let e=this.joblist;for(let t=0;t<e.length;t++)e[t].startTime=dt(e[t].startTime),e[t].endTime=dt(e[t].endTime),e[t].createTime=dt(e[t].createTime),"1970-01-01 08:00:00"==dt(e[t].startTime)&&(e[t].startTime=""),"1970-01-01 08:00:00"==dt(e[t].endTime)&&(e[t].endTime="");return e}},methods:{async startJob(e,t){let a=await Z(e,t);"200"==a.code?(this.$message({message:a.message,type:"success"}),this.handleCurrentChange(this.pagenum)):this.$message.error(a.message)},toJobInfo(e){this.$router.push("/jobinfo/"+e)},toCreateJob(){this.$router.push({name:"standardjob"})},async deleteJob(e,t){let a=await k(e,t);"200"==a.code?(this.$message({message:a.message,type:"success"}),this.handleCurrentChange(this.pagenum)):this.$message.error(a.message)},tableRowClassName({rowIndex:e}){return"Completed"===this.joblist[e].status?"success-row":parseInt(this.joblist[e].cpuUsed.split("C")[0])>=5||parseInt(this.joblist[e].memUsed.split("G")[0])>=10?"warning-row":""},handleCurrentChange(e){this.$store.dispatch("Job/getJobList",{envId:1,status:null,templateId:null,vcJobType:"batch",currPageNum:e,pageSize:this.page})},handleSizeChange(e){this.page=e,this.handleCurrentChange(1)}},mounted(){this.handleCurrentChange(1)}},pt=mt,ut=(0,te.Z)(pt,nt,ct,!1,null,"dcb93886",null),ht=ut.exports,gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{staticClass:"size",attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("模型管理")]),a("el-breadcrumb-item",[e._v("训练模型")])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[a("el-card",{staticClass:"left-card",attrs:{"body-style":{padding:"0px"}}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-row",[a("el-col",{staticStyle:{"margin-top":"12px"},attrs:{span:16}},[a("h3",{staticClass:"size",staticStyle:{"margin-left":"5px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 训练模型列表 ")])]),a("el-col",{attrs:{span:8}},[a("el-button",{staticStyle:{"margin-top":"10px","padding-right":"5px","padding-top":"5px","padding-bottom":"5px","padding-left":"3px"},attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:function(t){e.parentFileDialogVisible=!0}}},[e._v("新建")])],1)],1)],1),a("el-dialog",{attrs:{title:"新建训练模型",visible:e.parentFileDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.parentFileDialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入新建的训练模型名称",size:"small"},model:{value:e.newParentFileName,callback:function(t){e.newParentFileName=t},expression:"newParentFileName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.parentFileDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.createParentFile}},[e._v("确 定")])],1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-row",[a("el-table",{staticClass:"size",staticStyle:{width:"100%","margin-top":"10px"},attrs:{"highlight-current-row":"","show-header":!1,"max-height":"600","row-style":{height:"0px"},"cell-style":{padding:"0px"},data:e.parentFileList}},[a("el-table-column",{attrs:{prop:"name",label:"文件名",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"parentIcon",on:{click:function(a){return e.updateChileFileList(t.row.id,e.pageNum,null,t.row.name)}}},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"right",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",[a("el-col",{attrs:{span:12}},[a("i",{staticClass:"el-icon-edit-outline parentIcon",on:{click:function(a){return e.updateParentFileNameDialogVisible(t.row)}}})]),a("el-col",{attrs:{span:12}},[a("i",{staticClass:"el-icon-delete parentIcon",staticStyle:{"margin-left":"10px"},on:{click:function(a){return e.deleteParentFile(t.row.id)}}})])],1)]}}])})],1),a("el-dialog",{attrs:{title:"重命名数据集",visible:e.parentFileNameDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.parentFileNameDialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入重命名的数据集名称",size:"small"},model:{value:e.newParentFileName,callback:function(t){e.newParentFileName=t},expression:"newParentFileName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.parentFileNameDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.updateParentFileName()}}},[e._v("确 定")])],1)],1)],1)],1)],1)],1),a("el-col",{attrs:{span:20}},[a("el-card",{staticStyle:{height:"calc(100vh - 170px)","margin-top":"10px","margin-left":"10px",overflow:"auto"},attrs:{"body-style":{padding:"0px"}}},[a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:4}},[a("h3",{staticClass:"size",staticStyle:{"margin-left":"5px","margin-top":"3px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 训练模型文件列表 ")])]),a("el-col",{attrs:{span:20}},[e.parentFileName?a("h3",{staticClass:"size"},[e._v(" 当前训练模型: "),a("el-tag",{attrs:{size:"small"}},[e._v(e._s(e.parentFileName))])],1):e._e()])],1),a("el-row",{staticStyle:{"margin-top":"10px","margin-left":"10px","font-size":"20px"}},[a("el-input",{staticStyle:{width:"99%"},attrs:{disabled:"",size:"small"},model:{value:e.dirpath,callback:function(t){e.dirpath=t},expression:"dirpath"}},[a("template",{slot:"prepend"},[e._v("当前路径:")])],2)],1),a("el-row",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-d-arrow-left",size:"small"},on:{click:e.goBack}},[e._v("返回")])],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-folder-add",size:"small"},on:{click:function(t){e.fileDialogVisible=!0}}},[e._v("新建文件夹")])],1),a("el-dialog",{attrs:{title:"新建文件夹",visible:e.fileDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.fileDialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入新建的文件名",size:"small"},model:{value:e.newDirName,callback:function(t){e.newDirName=t},expression:"newDirName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.fileDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.newDir}},[e._v("确 定")])],1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-dropdown",{staticStyle:{"margin-top":"10px","margin-left":"10px"},on:{command:e.handleUpload}},[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-upload"}},[e._v(" 上传 "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"uploadFile"}},[e._v("上传文件")]),a("el-dropdown-item",{attrs:{command:"uploadFiles"}},[e._v("上传文件夹")])],1)],1)],1),a("el-dialog",{attrs:{title:"上传",visible:e.uploadDialogVisible,width:"433px","before-close":e.handleClose},on:{"update:visible":function(t){e.uploadDialogVisible=t}}},[a("el-progress",{staticStyle:{width:"380px","margin-top":"8px","margin-left":"15px","margin-bottom":"10px"},attrs:{percentage:e.progressPercent}}),a("el-row",{staticStyle:{"margin-bottom":"10px"}},[a("el-col",{attrs:{span:3,offset:17}},[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",size:"small"},on:{click:e.submitUpload}},[e._v("上 传")])],1),a("el-col",{attrs:{span:4}},[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:e.close}},[e._v("关 闭")])],1)],1),a("el-upload",{ref:"upload",staticStyle:{"margin-left":"15px"},attrs:{drag:"",action:"","http-request":e.uploadFile,multiple:"","auto-upload":!1}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或 "),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"})])],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:e.deleteFiles}},[e._v("删除选中")])],1)],1),a("el-row",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-table",{ref:"table",staticClass:"size",staticStyle:{width:"100%"},attrs:{data:e.childFileList,"max-height":"560"},on:{"select-all":e.selectTableAll,select:e.selectFile}},[a("el-table-column",{attrs:{width:"80",type:"selection"}}),a("el-table-column",{attrs:{prop:"fileName",label:"文件名","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",[a("el-col",{attrs:{span:1}},[1==t.row.fileType?a("i",{staticClass:"el-icon-folder"}):e._e(),1!=t.row.fileType?a("i",{staticClass:"el-icon-document"}):e._e()]),a("el-col",{attrs:{span:22,offset:1}},[e.isShow[t.$index]?a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],staticStyle:{"margin-left":"5px"},attrs:{size:"mini",placeholder:t.row.fileName},on:{blur:function(a){return e.updatename(t.$index,t.row)},focus:function(a){e.oldname=t.row.fileName}},model:{value:t.row.fileName,callback:function(a){e.$set(t.row,"fileName",a)},expression:"scope.row.fileName"}}):e._e(),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.isShow[t.$index],expression:"!isShow[scope.$index]"}],staticStyle:{"margin-left":"5px"},on:{click:function(a){return e.openDir(t.row)}}},[e._v(e._s(t.row.fileName))])],1)],1)]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"modifyTime",label:"修改时间",width:"300"}}),a("el-table-column",{attrs:{prop:"fileSize",label:"大小","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作",width:"200","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",icon:"el-icon-edit",size:"small"},on:{click:function(a){return e.changeIsShow(t.$index)}}},[e._v("重命名")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(a){return e.deleteFile(t.row.fileName)}}},[e._v("删除")])]}}])})],1)],1)],1),a("el-col",{staticStyle:{"text-align":"center"}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-pagination",{attrs:{background:!0,"page-sizes":[10,20,30],"page-size":e.page,layout:"prev, pager, next,sizes",total:Number(e.totalRecord)},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1)],1)],1)],1)},ft=[],wt=(a(6699),{name:"Data",data(){return{progressPercent:0,dataSetName:"",page:10,isShow:[],parentId:"",path:[],checkedfile:[],fileDialogVisible:!1,uploadDialogVisible:!1,parentFileDialogVisible:!1,parentFileNameDialogVisible:!1,newDirName:"",oldname:"",parentFileName:"",newParentFileName:"",newParentFileId:""}},directives:{focus:{inserted:function(e){e.querySelector("input").focus()}}},computed:{...(0,Q.rn)("File",["parentFileList","childFileList","pageNum","filePath","totalRecord"]),dirpath(){let e="";return this.path.forEach((t=>{e=e+"/"+t})),e}},methods:{updateChileFileList(e,t,a,s){this.path=[],this.parentId=e,this.parentFileName=s,this.updateFileList(e,t,a)},updateParentFileNameDialogVisible(e){this.parentFileNameDialogVisible=!0,this.newParentFileName=e.name,this.newParentFileId=e.id},async updateParentFileName(){let e=await F(this.newParentFileId,this.newParentFileName,"",6,1);"200"==e.code?(this.$message({type:"success",message:"更新成功"}),this.parentFileNameDialogVisible=!1,this.updateParentFileList(),this.newParentFileName=""):this.$message.error("更新失败")},async deleteParentFile(e){alert("是否确认删除?");let t=await L(e);"200"==t.code?(this.$message({type:"success",message:"删除成功"}),this.updateParentFileList()):this.$message.error(t.data)},async createParentFile(){let e=await N(this.newParentFileName,"",6,1);"200"==e.code?(this.parentFileDialogVisible=!1,this.$message({type:"success",message:"新建成功"}),this.updateParentFileList(),this.newParentFileName=""):this.$message.error("新建失败")},changeIsShow(e){let t=!this.isShow[e];this.isShow.splice(e,1,t)},initShow(){if(null!=this.childFileList)for(let e=0;e<this.childFileList.length;e++)this.isShow.push(!1)},previewFile(e){let t="http://127.0.0.1:8080/preview"+this.dirpath+"/"+e,s=a(9719).Base64;window.open("http://127.0.0.1:8012/onlinePreview?url="+encodeURIComponent(s.encode(t)))},async deleteFiles(){let e=await D(this.parentId,this.checkedfile,this.dirpath);"200"==e.code&&this.$message({type:"success",message:"删除成功"}),this.updateFileList(this.parentId,this.pageNum,this.dirpath),this.checkedfile=[]},async deleteFile(e){let t=[];t.push(e);let a=await D(this.parentId,t,this.dirpath);"200"==a.code&&this.$message({type:"success",message:"删除成功"}),this.updateFileList(this.parentId,this.pageNum,this.dirpath)},close(){this.uploadDialogVisible=!1,this.progressPercent=0,this.updateFileList(this.parentId,this.pageNum,this.dirpath),this.$refs.upload.clearFiles()},uploadFile(e){this.progressPercent=0;const t=new FormData;t.append("file",e.file);let a=e.file.size+"-"+e.file.name.substring(0,2)+e.file.name.split(".")[e.file.name.split(".").length-1],s=this;this.axios({url:"api/paas-web/bocapi/fileBcc/upload",method:"post",headers:{"Content-Type":"multipart/form-data"},data:{chunkNumber:"1",chunkSize:"2048000",currentChunkSize:e.file.size,totalSize:e.file.size,identifier:a,filename:e.file.name,relativePath:e.file.webkitRelativePath,totalChunks:"1",filePath:this.dirpath,rootPath:"/opt/bcc/storage1/",dataId:this.parentId,file:e.file},onUploadProgress(e){s.progressPercent=Math.round(e.loaded/e.total*100)}})},submitUpload(){this.$refs.upload.submit()},handleUpload(e){this.uploadDialogVisible=!0,"uploadFile"==e?this.$nextTick((()=>{this.$refs.upload.$children[0].$refs.input.webkitdirectory=!1})):this.$nextTick((()=>{this.$refs.upload.$children[0].$refs.input.webkitdirectory=!0}))},async newDir(){let e=await T(this.parentId,this.dirpath,this.newDirName,null);"200"==e.code?(this.$message({type:"success",message:"新建成功"}),this.updateFileList(this.parentId,this.pageNum,this.dirpath)):this.$message.error("新建失败:文件名重复!"),this.fileDialogVisible=!1,this.newDirName=""},handleClose(e){this.$confirm("确认关闭？").then((t=>{e()})).catch((e=>{})),this.updateFileList(this.parentId,this.pageNum,this.dirpath)},selectTableAll(){null!=this.childFileList&&(this.checkedfile.length>=this.childFileList.length?this.checkedfile=[]:(this.checkedfile=[],this.childFileList.forEach((e=>{this.checkedfile.push(e.fileName)}))))},selectFile(e,t){this.checkedfile.includes(t.fileName)?this.checkedfile.forEach((function(e,a,s){e==t.fileName&&s.splice(a,1)})):this.checkedfile.push(t.fileName),null!=this.childFileList&&this.checkedfile.length==this.childFileList.length?this.checkedall=!0:this.checkedall=!1},goBack(){this.path.pop(),this.updateFileList(this.parentId,1,this.dirpath)},openDir(e){1==e.fileType&&(this.path.push(e.fileName),this.updateFileList(this.parentId,1,this.dirpath))},updateFileList(e,t,a){null==e&&this.parentFileList.length>0&&(e=this.parentFileList[0].id,this.ParentFileName=this.parentFileList[0].fileName),this.$store.dispatch("File/getChildFileList",{dataId:e,filePath:a,current:t,size:this.page}),this.initShow()},async updateParentFileList(){let e=await C(1,0,0);"200"==e.code&&(this.$store.dispatch("File/getParentFileList",e.data),this.parentFileName=e.data[0].name),null!=this.parentFileList&&this.updateFileList(this.parentFileList[0].id,this.pageNum,null)},async updatename(e,t){if(this.changeIsShow(e),this.oldname!=t.fileName){let e=await z(this.parentId,this.dirpath,this.oldname,t.fileName);"200"==e.code?this.$message({type:"success",message:"修改成功"}):this.$message.error("修改失败")}else this.$message.warning("新名称与原名称相同")},handleCurrentChange(e){this.updateFileList(this.parentId,e,this.dirpath)},handleSizeChange(e){this.page=e,this.updateFileList(this.parentId,this.pageNum,this.dirpath)}},async mounted(){let e=await C(1,0,0);e.data.length>0&&(this.$store.dispatch("File/getParentFileList",e.data),this.parentFileName=e.data[0].name,"200"==e.code&&e.data.length>0&&this.$store.dispatch("File/getChildFileList",{dataId:e.data[0].id,filePath:null,current:1,size:this.page}),this.initShow(),this.parentId=e.data[0].id)}}),bt=wt,vt=(0,te.Z)(bt,gt,ft,!1,null,"3aa3d1f7",null),_t=vt.exports,yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{staticClass:"size",attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("镜像仓库")]),a("el-breadcrumb-item",[e._v("镜像管理")])],1)],1),a("el-card",{staticStyle:{height:"calc(100vh - 170px)","background-color":"#f0f1f3"},attrs:{"body-style":{padding:"0px"}}},[a("el-col",{staticStyle:{width:"320px"}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-select",{staticClass:"size",staticStyle:{width:"300px","margin-left":"10px"},attrs:{placeholder:"请选择仓库"},on:{change:e.selectChange},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})})),1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("div",{staticStyle:{height:"calc(100vh - 200px)",overflow:"auto"}},[e._l(e.imageCatalogs,(function(t,s){return a("div",{key:s,on:{click:function(t){return e.changeWareHouse(s)}}},[a("el-card",{staticStyle:{height:"200px",width:"300px","margin-top":"5px"},attrs:{shadow:"hover","body-style":{padding:"0px"}}},[a("div",{staticStyle:{height:"200px",width:"100%"},attrs:{id:"publicImageCharts"+s}})])],1)})),a("el-card",{staticStyle:{height:"180px",width:"300px","margin-top":"5px"},attrs:{shadow:"hover","body-style":{padding:"0px"}}},[a("el-empty",{attrs:{description:"暂无更多","image-size":50}})],1)],2)])],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("div",{staticStyle:{width:"100%"}},[a("el-card",{staticStyle:{height:"calc(100vh - 170px)","margin-left":"10px","overflow-y":"auto"},attrs:{shadow:"hover","body-style":{padding:"0px"}}},[a("el-row",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{staticClass:"size",attrs:{separator:">"}},[a("el-breadcrumb-item",[e._v("镜像仓库")]),a("el-breadcrumb-item",[e._v("镜像管理")]),e.selected?a("el-breadcrumb-item",[e._v(e._s(e.selected))]):e._e()],1)],1)],1),e.selected&&0==e.isShow?a("el-row",[a("el-col",{staticStyle:{margin:"10px"},attrs:{span:4}},[a("el-input",{attrs:{size:"small",placeholder:"请输入镜像名称"},model:{value:e.imageName,callback:function(t){e.imageName=t},expression:"imageName"}})],1),a("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:4}},[a("el-button",{staticClass:"el-icon-search",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.searchImageList()}}},[e._v("搜索")])],1)],1):e._e(),a("div",{staticStyle:{height:"calc(100vh - 300px)",width:"100%",overflow:"auto"}},[e.selected?e._e():a("el-result",{staticStyle:{"margin-top":"150px"},attrs:{icon:"info",title:"信息提示",subTitle:"点击左侧镜像仓库查看仓库详细信息"}}),e.showInfo?a("el-result",{staticStyle:{"margin-top":"150px"},attrs:{icon:"info",title:"信息提示",subTitle:"没有符合要求的镜像"}}):e._e(),e._l(e.imageList,(function(t,s){return e.selected?a("el-row",{key:s},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut"}},[e.showImages[s].head?a("el-card",{staticStyle:{"margin-top":"10px",height:"40px"},attrs:{"body-style":{padding:"0px"}}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShow,expression:"!isShow"}],staticClass:"circle",on:{click:function(a){return e.changeShowImages(s,t.imageName)}}},[a("i",{staticClass:"el-icon-arrow-right",staticStyle:{"margin-top":"5px","margin-left":"4px"}})]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"circle",on:{click:function(t){return e.fixShowImages(s)}}},[a("i",{staticClass:"el-icon-arrow-down",staticStyle:{"margin-top":"4px","margin-left":"4px"}})]),a("span",{staticClass:"size",staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.imageName))])]):e._e()],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut"}},[a("el-row",[a("el-descriptions",{directives:[{name:"show",rawName:"v-show",value:e.showImages[s].body,expression:"showImages[index].body"}],staticStyle:{"margin-left":"30px"}},[a("el-descriptions-item",{attrs:{label:"镜像名称"}},[e._v(e._s(t.imageName))]),a("el-descriptions-item",{attrs:{label:"所属仓库"}},[e._v("default")]),a("el-descriptions-item",{attrs:{label:"仓库服务IP"}},[e._v("192.168.0.199")])],1),a("el-timeline",{directives:[{name:"show",rawName:"v-show",value:e.showImages[s].body,expression:"showImages[index].body"}],staticStyle:{"margin-left":"30px"}},e._l(e.activities,(function(t,s){return a("el-timeline-item",{key:s,attrs:{icon:t.icon,type:t.type,color:t.color,size:t.size,timestamp:t.timestamp}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("el-row",[a("el-col",{attrs:{span:20}},[a("el-descriptions",{staticStyle:{"margin-top":"10px","margin-left":"10px"}},[a("el-descriptions-item",{attrs:{label:"版本号"}},[e._v(e._s(t.content))]),a("el-descriptions-item",{attrs:{label:"镜像大小"}},[e._v(e._s(t.fileSize))])],1)],1),a("el-col",{attrs:{span:4}})],1)],1)],1)})),1)],1)],1)],1):e._e()}))],2),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeIn","leave-active-class":"animate__animated animate__fadeOut"}},[e.selected&&0==e.isShow?a("el-row",{staticStyle:{"text-align":"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:Number(e.totalCount)},on:{"current-change":e.handleCurrentChange}})],1):e._e()],1)],1)],1)])],1)],1)},It=[];const xt=e=>{if(e<1024)return e+"B";if(e<1048576){var t=e/1024;return t=t.toFixed(2),t+"KB"}if(e<1073741824){t=e/1048576;return t=t.toFixed(2),t+"MB"}t=e/1073741824;return t=t.toFixed(2),t+"GB"};var St={name:"Images",data(){return{showInfo:!1,activities:[],isShow:!1,Image:[],title:[],options:[],selected:"",imageCatalogId:0,showImages:[],imageName:"",index:0}},computed:{...(0,Q.rn)("Image",["warehouseId","warehouseName","imageCatalogs","imageList","totalCount","currPageNum"])},methods:{async handleCurrentChange(e){let t=await O(e,this.imageCatalogs[this.index].catalogId,this.imageCatalogs[this.index].catalogType,null,10,this.warehouseId);if(1==t.success&&null!=t.rows){this.showImages=[],this.$store.dispatch("Image/getImageList",{imageList:t.rows,totalCount:t.totalCount,currPageNum:t.currPageNum});for(let e=0;e<t.rows.length;e++)this.showImages.push({head:!0,body:!1})}},fixShowImages(e){this.showInfo=!1,this.isShow=!this.isShow,this.activities=[];for(let t=0;t<this.showImages.length;t++)this.showImages[t].head=!0,this.showImages[t].body=!1},async changeShowImages(e,t){this.showInfo=!1;let a=await R(t);if(1==a.success){this.$store.dispatch("Image/getImageVersionList",a.rows);for(let e=0;e<a.rows.length;e++){let t={content:"",fileSize:"",timestamp:"",size:"large",type:"primary",icon:"el-icon-star-on",color:"#0bbd87"},s={content:"",fileSize:"",timestamp:"",size:"large",type:"primary"};0==e?(t.content=a.rows[e].imageTag,t.timestamp=dt(a.rows[e].imageCreatetime),t.fileSize=xt(a.rows[e].imageSize),this.activities.push(t)):(s.content=a.rows[e].imageTag,s.timestamp=dt(a.rows[e].imageCreatetime),s.fileSize=xt(a.rows[e].imageSize),this.activities.push(s))}}this.isShow=!this.isShow;for(let s=0;s<this.showImages.length;s++)s!=e&&(this.showImages[s].head=!1),s==e&&(this.showImages[s].body=!0)},selectChange(e){this.showInfo=!1,this.activities=[];let t=this.options.findIndex(((t,a)=>t.value==e));this.changeWareHouse(t)},async changeWareHouse(e){this.showInfo=!1,this.index=e,this.activities=[],this.selected=this.title[e].text,this.isShow=!1;let t=await O(1,this.imageCatalogs[e].catalogId,this.imageCatalogs[e].catalogType,null,10,this.warehouseId);if(1==t.success&&null!=t.rows){this.showImages=[],this.$store.dispatch("Image/getImageList",{imageList:t.rows,totalCount:t.totalCount,currPageNum:t.currPageNum});for(let e=0;e<t.rows.length;e++)this.showImages.push({head:!0,body:!1})}},async searchImageList(){let e=await O(1,this.imageCatalogs[this.index].catalogId,this.imageCatalogs[this.index].catalogType,this.imageName,10,this.warehouseId);if(1==e.success){this.showImages=[],this.$store.dispatch("Image/getImageList",{imageList:e.rows,totalCount:e.totalCount,currPageNum:e.currPageNum});for(let t=0;t<e.rows.length;t++)this.showImages.push({head:!0,body:!1});0==e.rows.length?this.showInfo=!0:this.showInfo=!1,this.imageName=""}},initEcharts(e,t){let a={title:this.title[t],tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{right:"14%",top:"37%",orient:"vertical",selected:{"总   数":!1},selectedMode:!1,formatter:function(e){for(var t,s=a.series[0].data,i=0,l=0;l<s.length;l++)i+=s[l].value,s[l].name==e&&(t=s[l].value);var o=t;Math.round(t/i*100);return`${e}:  ${o}`}},series:[{name:"详细",type:"pie",radius:[10,50],center:["25%","60%"],roseType:"radius",label:{show:!1},data:this.Image[t]}]};this.$echarts.init(e).setOption(a)}},async mounted(){let e=await V(1);if("200"==e.code&&this.$store.dispatch("Image/getImageOverview",{warehouseId:e.data.warehouseInfo[0].warehouseId,warehouseName:e.data.warehouseInfo[0].warehouseName,imageCatalogs:e.data.warehouseInfo[0].imageCatalogs}),null!=e.data.warehouseInfo[0].imageCatalogs)for(let t=0;t<e.data.warehouseInfo[0].imageCatalogs.length;t++){let a={value:""},s=[{value:0,name:"总   数"},{value:0,name:"已扫描"},{value:0,name:"扫描中"},{value:0,name:"未扫描"}],i={text:"",left:"center",top:"15px"};s[0].value=e.data.warehouseInfo[0].imageCatalogs[t].catalogOverview.total,s[1].value=e.data.warehouseInfo[0].imageCatalogs[t].catalogOverview.scanned,s[2].value=e.data.warehouseInfo[0].imageCatalogs[t].catalogOverview.scanning,s[3].value=e.data.warehouseInfo[0].imageCatalogs[t].catalogOverview.notScanned,a.value=e.data.warehouseInfo[0].imageCatalogs[t].envName,i.text=e.data.warehouseInfo[0].imageCatalogs[t].envName,"cluster-default-default"==i.text&&(i.text="private"),this.Image.push(s),this.options.push(a),this.title.push(i)}this.$nextTick((()=>{for(let e=0;e<this.Image.length;e++)this.initEcharts(document.getElementById("publicImageCharts"+e),e)}))}},kt=St,Ct=(0,te.Z)(kt,yt,It,!1,null,"f1da2658",null),Pt=Ct.exports,Nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{staticClass:"size",attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("我的作业")]),a("el-breadcrumb-item",[e._v("新建作业")])],1)],1),a("el-card",{staticClass:"card-style",staticStyle:{height:"calc(100vh - 170px)",overflow:"auto"},attrs:{shadow:"hover","body-style":{padding:"0px"}}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-row",[a("h3",{staticClass:"size",staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 作业属性 ")])])],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-form",{ref:"jobForm",staticStyle:{"min-width":"1000px",padding:"0px"},attrs:{"label-position":"right","label-width":"100px",model:e.vcJob,rules:e.vcJobRules}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{staticStyle:{"margin-left":"50px"},attrs:{label:"作业中文名",prop:"vcJobCnName"}},[a("el-col",[a("el-input",{staticStyle:{width:"340px","margin-left":"0px"},attrs:{size:"small",placeholder:"请输入作业中文名"},model:{value:e.vcJob.vcJobCnName,callback:function(t){e.$set(e.vcJob,"vcJobCnName",t)},expression:"vcJob.vcJobCnName"}})],1)],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"作业英文名",prop:"vcJobName"}},[a("el-col",[a("el-input",{staticStyle:{width:"340px"},attrs:{placeholder:"请输入作业英文名",size:"small"},model:{value:e.vcJob.vcJobName,callback:function(t){e.$set(e.vcJob,"vcJobName",t)},expression:"vcJob.vcJobName"}})],1)],1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{staticStyle:{"margin-top":"4px"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.jobDialogVisible=!0}}},[e._v("高级配置")])],1)],1),a("el-dialog",{attrs:{title:"作业高级配置",visible:e.jobDialogVisible},on:{"update:visible":function(t){e.jobDialogVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"作业优先级",prop:"priorityClassName"}},[a("el-col",[a("el-select",{staticStyle:{width:"250px"},attrs:{size:"small",placeholder:"请选择作业的优先级"},model:{value:e.vcJob.priorityClassName,callback:function(t){e.$set(e.vcJob,"priorityClassName",t)},expression:"vcJob.priorityClassName"}},[a("el-option",{attrs:{label:"高",value:"high-priority"}}),a("el-option",{attrs:{label:"中",value:"middle-priority"}}),a("el-option",{attrs:{label:"低",value:"low-priority"}})],1)],1)],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"所属集群"}},[a("el-col",[a("el-select",{staticStyle:{width:"250px"},attrs:{size:"small"},model:{value:e.vcJob.queueName,callback:function(t){e.$set(e.vcJob,"queueName",t)},expression:"vcJob.queueName"}},[a("el-option",{attrs:{label:"default",value:"default"}})],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"并行运行"}},[a("el-col",[a("el-switch",{model:{value:e.vcJob.parallelExecution,callback:function(t){e.$set(e.vcJob,"parallelExecution",t)},expression:"vcJob.parallelExecution"}})],1)],1)],1),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{label:"重启次数",prop:"maxRetry"}},[a("el-col",[a("el-input-number",{staticStyle:{width:"250px"},attrs:{size:"small",min:0,max:100},model:{value:e.vcJob.maxRetry,callback:function(t){e.$set(e.vcJob,"maxRetry",t)},expression:"vcJob.maxRetry"}})],1)],1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:2}},[a("h3",{staticClass:"size",staticStyle:{"margin-top":"8px","margin-left":"10px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 任务属性 ")])]),a("el-col",{attrs:{span:1}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.getImage}},[e._v("添加")])],1)],1),a("el-table",{staticStyle:{width:"100%","margin-top":"10px","margin-left":"10px","font-size":"16px"},attrs:{"cell-style":{padding:"5px"},data:e.tasks,border:!0,"row-style":{height:"30px"},"max-height":"400px"}},[a("el-table-column",{attrs:{prop:"taskCnName",label:"任务中文名称"}}),a("el-table-column",{attrs:{prop:"taskName",label:"任务英文名称"}}),a("el-table-column",{attrs:{prop:"requestCpu",label:"CPU核心数(核)"}}),a("el-table-column",{attrs:{prop:"requestMemory",label:"内存使用量(GB)"}}),a("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.deleteTask(t.$index)}}},[e._v("删除")])]}}])})],1),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-row",[a("el-col",{attrs:{span:2,offset:22}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.createJob}},[e._v("创建")])],1)],1)],1)],1)],1)],1),a("el-dialog",{attrs:{title:"新建任务",visible:e.dialogFormVisible,width:"1000px"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"taskForm",staticStyle:{padding:"0px","min-width":"900px"},attrs:{rules:e.taskRules,model:e.taskInfo,"label-position":"right","label-width":"70px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务英文名","label-width":e.formLabelWidth,prop:"taskName"}},[a("el-input",{staticStyle:{width:"340px"},attrs:{autocomplete:"off",placeholder:"请输入任务英文名"},model:{value:e.taskInfo.taskName,callback:function(t){e.$set(e.taskInfo,"taskName",t)},expression:"taskInfo.taskName"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"任务中文名","label-width":e.formLabelWidth,prop:"taskCnName"}},[a("el-input",{staticStyle:{width:"340px"},attrs:{autocomplete:"off",placeholder:"请输入任务中文名"},model:{value:e.taskInfo.taskCnName,callback:function(t){e.$set(e.taskInfo,"taskCnName",t)},expression:"taskInfo.taskCnName"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"选择仓库","label-width":e.formLabelWidth,prop:"repositoryDir"}},[a("el-select",{staticStyle:{width:"250px"},on:{change:e.changeImageCatalog},model:{value:e.taskInfo.repositoryDir,callback:function(t){e.$set(e.taskInfo,"repositoryDir",t)},expression:"taskInfo.repositoryDir"}},e._l(e.imageCatalogList,(function(e,t){return a("el-option",{attrs:{label:"cluster-default-default"==e.envName?"private":e.envName,value:e.catalogId}})})),1)],1)],1),a("el-col",{attrs:{span:9}},[a("el-form-item",{attrs:{label:"选择镜像","label-width":e.formLabelWidth,prop:"imagePrefix"}},[a("el-select",{staticStyle:{width:"250px"},attrs:{placeholder:"请选择镜像"},on:{change:e.changeImage},model:{value:e.taskInfo.imagePrefix,callback:function(t){e.$set(e.taskInfo,"imagePrefix",t)},expression:"taskInfo.imagePrefix"}},e._l(e.imageList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.imageName,value:e.imageName}})})),1)],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{label:"选择版本","label-width":e.formLabelWidth,prop:"imageVersion"}},[a("el-select",{staticStyle:{width:"100px"},attrs:{placeholder:"请选择镜像版本"},model:{value:e.taskInfo.imageVersion,callback:function(t){e.$set(e.taskInfo,"imageVersion",t)},expression:"taskInfo.imageVersion"}},e._l(e.imageVersionList,(function(e,t){return a("el-option",{key:t,attrs:{label:e.imageTag,value:e.imageTag}})})),1)],1)],1)],1),a("el-form-item",{staticStyle:{width:"900px"},attrs:{label:"GPU算力","label-width":e.formLabelWidth}},[a("el-row",{staticStyle:{"margin-top":"0px"}},[a("el-col",{attrs:{span:20}},[e.taskInfo.gpuCalPower<100?a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,step:25,max:100},on:{change:function(t){e.taskInfo.gpuVideoMem=2.56*e.taskInfo.gpuCalPower}},model:{value:e.taskInfo.gpuCalPower,callback:function(t){e.$set(e.taskInfo,"gpuCalPower",t)},expression:"taskInfo.gpuCalPower"}}):e._e(),e.taskInfo.gpuCalPower>=100?a("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,step:100,max:300},on:{change:function(t){e.taskInfo.gpuVideoMem=2.56*e.taskInfo.gpuCalPower}},model:{value:e.taskInfo.gpuCalPower,callback:function(t){e.$set(e.taskInfo,"gpuCalPower",t)},expression:"taskInfo.gpuCalPower"}}):e._e()],1),a("el-col",{attrs:{span:3}},[a("span",{staticStyle:{"font-size":"16px","margin-left":"10px"}},[e._v("(%)")])]),a("el-col",{attrs:{span:1}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[e._v(" 1、输入1-100内的整数，例如50，是指将50%的cuda core分配给该服务。 ")]),a("p",[e._v(" 2、输入大于100的整数，只能是100的倍数，如200，是指将2张GPU卡都分给该服务。 ")]),a("p",[e._v(" 3、如果输入大于等于100的整数，GPU显存不用再填写，默认使用GPU的全部显存。 ")]),a("p",[e._v('4、如果值为空或0时，默认不使用GPU算力"')])]),a("i",{staticClass:"el-icon-question",staticStyle:{color:"#409eff","margin-left":"10px",cursor:"pointer"}})])],1)],1)],1),a("el-form-item",{staticStyle:{width:"900px"},attrs:{label:"GPU显存","label-width":e.formLabelWidth}},[a("el-row",{staticStyle:{"margin-top":"0px"}},[a("el-col",{attrs:{span:20}},[a("el-slider",{staticStyle:{width:"100%"},attrs:{max:Number(88)},model:{value:e.taskInfo.gpuVideoMem,callback:function(t){e.$set(e.taskInfo,"gpuVideoMem",t)},expression:"taskInfo.gpuVideoMem"}})],1),a("el-col",{attrs:{span:3}},[a("span",{staticStyle:{"font-size":"16px","margin-left":"10px"}},[e._v(e._s(.25*Number(e.taskInfo.gpuVideoMem))+"Gi")])]),a("el-col",{attrs:{span:1}},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("p",[e._v(" 注：Gi为单位时，拖动一格显示1，为0.25Gi，拖动2格显示2，为0.5Gi，以此类推；最大能拖动256格显示256，为64Gi ")])]),a("i",{staticClass:"el-icon-question",staticStyle:{color:"#409eff","margin-left":"10px",cursor:"pointer"}})])],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"故障响应","label-width":e.formLabelWidth}},[a("el-select",{staticStyle:{width:"340px"},attrs:{placeholder:"请选择当前任务状态",clearable:""},on:{change:e.changeTaskpoliciesEvent,clear:function(t){e.taskInfo.policiesAction=""}},model:{value:e.taskInfo.policiesEvent,callback:function(t){e.$set(e.taskInfo,"policiesEvent",t)},expression:"taskInfo.policiesEvent"}},[a("el-option",{attrs:{label:"运行失败",value:"PodFailed"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"响应方式","label-width":e.formLabelWidth}},[a("el-select",{staticStyle:{width:"340px"},attrs:{placeholder:"请选择变更任务状态",clearable:""},on:{change:e.changeTaskpoliciesAction,clear:function(t){e.taskInfo.policiesEvent=""}},model:{value:e.taskInfo.policiesAction,callback:function(t){e.$set(e.taskInfo,"policiesAction",t)},expression:"taskInfo.policiesAction"}},[a("el-option",{attrs:{label:"任务完成",value:"CompleteJob"}}),a("el-option",{attrs:{label:"任务重启",value:"RestartJob"}})],1)],1)],1)],1),a("el-form-item",{attrs:{label:"高级配置","label-width":e.formLabelWidth}},[a("el-tabs",{staticStyle:{width:"820px"}},[a("el-tab-pane",{attrs:{label:"添加存储变量",name:"second"}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("el-row",[a("h3",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 添加变量 ")])]),a("el-row"),a("el-form",{ref:"storageForm",staticStyle:{padding:"0px"},attrs:{model:e.mount,rules:e.mountRules,"label-position":"right","label-width":"136px"}},[a("el-row",[a("el-form-item",{attrs:{label:"路径地址",prop:"hostPath"}},[a("el-col",{staticStyle:{"margin-left":"0px"},attrs:{span:24,offset:1}},[a("el-input",{staticStyle:{width:"440px"},attrs:{size:"small"},model:{value:e.mount.hostPath,callback:function(t){e.$set(e.mount,"hostPath",t)},expression:"mount.hostPath"}},[a("template",{slot:"append"},[a("span",{staticStyle:{cursor:"pointer"},on:{click:e.initData}},[e._v(" 选择数据服务")])])],2)],1)],1)],1),a("el-dialog",{attrs:{title:"目录挂载",visible:e.childDialogTableVisible,"append-to-body":"",width:"500px"},on:{"update:visible":function(t){e.childDialogTableVisible=t}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{size:"small",placeholder:"搜索"},model:{value:e.dataName,callback:function(t){e.dataName=t},expression:"dataName"}})],1),a("el-col",{attrs:{span:8,offset:4}},[a("el-button-group",[a("el-button",{attrs:{type:1==e.type?"success":"primary",size:"small"},on:{click:function(t){return e.getDataSet(1)}}},[e._v("数据集")]),a("el-button",{attrs:{type:1!=e.type?"success":"primary",size:"small"},on:{click:function(t){return e.getDataSet(2)}}},[e._v("结果集")])],1)],1)],1),a("el-table",{attrs:{data:e.selectedData,"highlight-current-row":"","max-height":"300"},on:{"row-click":e.initRealPath}},[a("el-table-column",{attrs:{property:"name",label:1==e.type?"数据集":"结果集",width:"150"}}),a("el-table-column",{attrs:{property:"catalog",label:"路径",width:"300"}})],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.childDialogTableVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.childDialogTableVisible=!1}}},[e._v("确 定")])],1)],1),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-form-item",{attrs:{label:"容器内路径",prop:"mountPath"}},[a("el-col",{staticStyle:{"margin-left":"0px"},attrs:{span:24,offset:1}},[a("el-input",{staticStyle:{width:"440px"},attrs:{size:"small"},model:{value:e.mount.mountPath,callback:function(t){e.$set(e.mount,"mountPath",t)},expression:"mount.mountPath"}})],1)],1)],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-top":"15px"},attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addMountData()}}},[e._v("添加")])],1)],1)],1)],1),a("el-tab-pane",{attrs:{label:"管理存储变量",name:"third"}},[a("el-card",{attrs:{"body-style":{padding:"0px"}}},[a("el-row",[a("h3",{staticStyle:{"margin-left":"10px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 管理变量 ")])]),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{border:"",data:e.mountData,"row-style":{height:"40px"},"cell-style":{padding:"5px"},"max-height":"200"}},[a("el-table-column",{attrs:{label:"路径地址",prop:"hostPath"}}),a("el-table-column",{attrs:{label:"容器内路径",prop:"mountPath"}}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"margin-buttom":"3px"},attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.deleteMountData(t.$index)}}},[e._v("删除")])]}}])})],1)],1)],1)],1)],1)],1),a("el-form-item",{attrs:{label:"备注","label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"820px"},attrs:{type:"textarea",placeholder:"请输入内容",maxlength:"30","show-word-limit":""},model:{value:e.taskInfo.description,callback:function(t){e.$set(e.taskInfo,"description",t)},expression:"taskInfo.description"}})],1),a("el-form-item",[a("el-button",{staticStyle:{"margin-left":"725px"},on:{click:function(t){return e.cancleTask()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.createTask()}}},[e._v("确 定")])],1)],1)],1)],1)},Lt=[],Ft={name:"CreateJob",data(){return{jobDialogVisible:!1,mount:{hostPath:"",mountPath:"/"},mountRules:{hostPath:[{required:!0,message:"不能为空",trigger:"blur"}],mountPath:[{required:!0,message:"不能为空",trigger:"blur"}]},mountData:[],type:1,dataName:"",childDialogTableVisible:!1,vcJob:{vcJobId:"",vcJobCnName:"",vcJobName:"",vcJobType:"batch",queueName:"default",queueId:1,maxRetry:0,priorityClassName:"middle-priority",parallelExecution:!0},vcJobRules:{vcJobCnName:[{required:!0,message:"请输入作业中文名",trigger:"blur"},{min:4,max:45,message:"长度在4到45字符",trigger:"blur"}],vcJobName:[{required:!0,message:"请输入作业英文名",trigger:"blur"},{min:4,max:45,message:"请输入4-45位小写字母，数字，中划线组合并以字母开头",trigger:"blur"}],maxRetry:[{required:!0,message:"请输入作业尝试重启次数",trigger:"blur"}],priorityClassName:[{required:!0,message:"请选择作业优先级",trigger:"change"}]},target:{templateId:null,clusterId:0,startNow:!1,envId:1},tasks:[],taskInfo:{taskName:"",taskCnName:"",podReplicas:1,podMinReplicas:1,requestCpu:1,requestMemory:4,gpuCalPower:100,gpuVideoMem:88,command:null,workingDir:null,description:"",repository:"default",repositoryDir:"cluster-default-default",image:"",imagePrefix:"",imageVersion:"",policiesAction:"",policiesEvent:"",containerOptions:"",oldContainerOptions:'{"bocoPlatform-ports":[],"bocoPlatform-envs":[],"bocoPlatform-configs":[],"bocoPlatform-lifecycle":[],"bocoPlatform-probe":[],"bocoPlatform-volumes":[],"bocoPlatform-schedulingManagement":[]}'},taskRules:{taskName:[{required:!0,message:"请输入作业英文名",trigger:"blur"},{min:4,max:45,message:"请输入4-45位小写字母，数字，中划线组合并以字母开头",trigger:"blur"}],taskCnName:[{required:!0,message:"请输入作业中文名",trigger:"blur"},{min:4,max:45,message:"长度在4到45字符",trigger:"blur"}],repository:[{required:!0,trigger:"change"}],repositoryDir:[{required:!0,trigger:"change"}],imagePrefix:[{required:!0,trigger:"change"}],imageVersion:[{required:!0,trigger:"change"}]},dialogFormVisible:!1,formLabelWidth:"120px",bocoPlatformenvs:[],bocoPlatformports:[],bocoPlatformschedulingManagement:[],bocoPlatformlifecycle:[],bocoPlatformprobe:[],bocoPlatformconfigs:[],bocoPlatformconfigMounts:[],bocoPlatformvolumes:[],bocoPlatformvolumeMounts:[]}},computed:{...(0,Q.rn)("CreateJob",["queueList","warehouseList","imageCatalogList","imageList","imageVersionList","data"]),fullImage(){return this.taskInfo.imagePrefix+":"+this.taskInfo.imageVersion},selectedData(){let e=[];return""==this.dataName?this.data:(this.data.forEach((t=>{-1!=t.name.indexOf(this.dataName)&&e.push(t)})),e)}},methods:{changeTaskpoliciesEvent(e){"PodFailed"==e&&(this.taskInfo.policiesAction="CompleteJob")},changeTaskpoliciesAction(e){e&&(this.taskInfo.policiesEvent="PodFailed")},createJob(){let e=this;this.$refs["jobForm"].validate((async t=>{if(!t)return!1;{e.vcJob.queueId=e.queueList[0].queueId;let t=await H({tasks:e.tasks,target:e.target,vcJob:e.vcJob});"200"==t.code&&e.$router.push("/job")}}))},createAndStartJob(){let e=this;this.$refs["jobForm"].validate((async t=>{if(!t)return!1;{e.target.startNow=!0,e.vcJob.queueId=e.queueList[0].queueId;let t=await H({tasks:e.tasks,target:e.target,vcJob:e.vcJob});"200"==t.code?(e.$message({type:"success",message:t.message}),e.$router.push("/job")):e.$message({type:"warning",message:t.message})}}))},async getImage(){this.dialogFormVisible=!0;let e=await j(this.imageCatalogList[1].catalogId);if("200"==e.code){this.$store.dispatch("CreateJob/getImage",e.data);let t=await B(e.data[0].imageName);1==t.success&&this.$store.dispatch("CreateJob/getImageVersion",t.rows)}this.initImageSelected()},deleteTask(e){this.tasks.splice(e,1)},createTask(){let e=this;this.$refs["taskForm"].validate((t=>{if(!t)return!1;{e.dialogFormVisible=!1;let t=e.formatTaskInfo();e.tasks.push(t),e.vcJob.vcJobName="work-"+e.tasks[0].taskCnName,e.vcJob.vcJobCnName=e.vcJob.vcJobName,e.cancleTask()}}))},formatTaskInfo(){let e={};e.taskName=this.taskInfo.taskName,e.taskCnName=this.taskInfo.taskCnName,e.podReplicas=this.taskInfo.podReplicas,e.podMinReplicas=this.taskInfo.podMinReplicas,e.requestCpu=this.taskInfo.requestCpu,e.requestMemory=this.taskInfo.requestMemory,e.gpuCalPower=this.taskInfo.gpuCalPower,e.gpuVideoMem=this.taskInfo.gpuVideoMem,e.command=this.taskInfo.command,e.workingDir=this.taskInfo.workingDir,e.description=this.taskInfo.description,e.repository=this.taskInfo.repository,e.repositoryDir=this.taskInfo.repositoryDir,e.image=this.fullImage,e.policiesAction=this.taskInfo.policiesAction,e.policiesEvent=this.taskInfo.policiesEvent;let t="",a="";for(let s=0;s<this.mountData.length;s++)t+='{"name":"name'+s+'","hostPath":"'+this.mountData[s].hostPath+'"},',a+='{"name":"name'+s+'","mountPath":"'+this.mountData[s].mountPath+'"}';return e.containerOptions='{"bocoPlatform-envs":[],"bocoPlatform-ports":[],"bocoPlatform-schedulingManagement":[],"bocoPlatform-lifecycle":[],"bocoPlatform-probe":[],"bocoPlatform-configs":[],"bocoPlatform-configMounts":[],"bocoPlatform-volumes":['+t+'],"bocoPlatform-volumeMounts":['+a+"]}",e.oldContainerOptions='{"bocoPlatform-ports":[],"bocoPlatform-envs":[],"bocoPlatform-configs":[],"bocoPlatform-lifecycle":[],"bocoPlatform-probe":[],"bocoPlatform-volumes":[],"bocoPlatform-schedulingManagement":[]}',e},cancleTask(){this.dialogFormVisible=!1,this.taskInfo={taskName:"",taskCnName:"",podReplicas:0,podMinReplicas:0,requestCpu:1,requestMemory:1,gpuCalPower:0,gpuVideoMem:0,command:null,workingDir:null,description:"",repository:"",repositoryDir:"",image:"",imagePrefix:"",imageVersion:"",policiesAction:"",policiesEvent:"",containerOptions:"",oldContainerOptions:'{"bocoPlatform-ports":[],"bocoPlatform-envs":[],"bocoPlatform-configs":[],"bocoPlatform-lifecycle":[],"bocoPlatform-probe":[],"bocoPlatform-volumes":[],"bocoPlatform-schedulingManagement":[]}'},this.initImageSelected(),this.mountData=[],this.clearValidate("taskForm"),this.clearValidate("storageForm")},clearValidate(e){this.$refs[e].clearValidate()},deleteMountData(e){this.mountData.splice(e,1)},addMountData(){this.$refs["storageForm"].validate((e=>{if(!e)return!1;{let e={hostPath:"",mountPath:""};e.hostPath=this.mount.hostPath,e.mountPath=this.mount.mountPath,this.mountData.push(e),this.mount.hostPath="",this.mount.mountPath="/",this.$message({type:"success",message:"添加成功!"})}}))},initRealPath(e,t,a){this.mount.hostPath=e.catalog},initData(){this.childDialogTableVisible=!0,this.getDataSet(this.type)},async getDataSet(e){this.type=e;let t=await G(this.type);200==t.code&&this.$store.dispatch("CreateJob/getDataSet",t.data)},async changeImage(e){let t=await B(result4.data[0].imageName);1==t.success&&this.$store.dispatch("CreateJob/getImageVersion",t.rows),this.taskInfo.imagePrefix=e,this.taskInfo.imageVersion=this.imageVersionList[0].imageTag},async changeImageCatalog(e){let t=await j(e);if("200"==t.code){this.$store.dispatch("CreateJob/getImage",t.data);let e=await B(t.data[0].imageName);1==e.success&&this.$store.dispatch("CreateJob/getImageVersion",e.rows)}this.taskInfo.repositoryDir=e,this.taskInfo.imagePrefix=this.imageList[0].imageName,this.taskInfo.imageVersion=this.imageVersionList[0].imageTag,this.updateName()},initImageSelected(){this.taskInfo.repository=this.warehouseList[0].warehouseId,this.taskInfo.repositoryDir=this.imageCatalogList[this.imageCatalogList.length-1].catalogId,this.taskInfo.imagePrefix=this.imageList[0].imageName,this.taskInfo.imageVersion=this.imageVersionList[0].imageTag,this.updateName()},updateName(){var e=new Date;this.taskInfo.taskCnName="task"+(e.getMonth()+1)+e.getHours()+e.getMinutes()+e.getSeconds(),this.taskInfo.taskName=this.taskInfo.taskCnName}},async mounted(){let e=await M();if(1==e.success){this.$store.dispatch("CreateJob/getQueueList",e.rows);let t=await U(e.rows[0].clusterId);if("200"==t.code){this.$store.dispatch("CreateJob/getWareHouseList",t.data);let e=await q(t.data[0].warehouseId);"200"==e.code&&this.$store.dispatch("CreateJob/getWareHouseImageList",e.data)}}}},zt=Ft,Tt=(0,te.Z)(zt,Nt,Lt,!1,null,"47d9225c",null),$t=Tt.exports,Et=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("模型管理")]),a("el-breadcrumb-item",[e._v("测试模型")])],1)],1),a("el-row",[a("el-col",{attrs:{span:4}},[a("el-card",{staticClass:"left-card",attrs:{"body-style":{padding:"0px"}}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-row",[a("el-col",{staticStyle:{"margin-top":"12px"},attrs:{span:16}},[a("h3",{staticClass:"size",staticStyle:{"margin-left":"5px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 测试模型列表 ")])]),a("el-col",{attrs:{span:8}},[a("el-button",{staticStyle:{"margin-top":"10px","padding-right":"5px","padding-top":"5px","padding-bottom":"5px","padding-left":"3px"},attrs:{type:"primary",icon:"el-icon-circle-plus-outline",size:"mini"},on:{click:function(t){e.parentFileDialogVisible=!0}}},[e._v("新建")])],1)],1)],1),a("el-dialog",{attrs:{title:"新建测试模型",visible:e.parentFileDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.parentFileDialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入新建的测试模型名称",size:"small"},model:{value:e.newParentFileName,callback:function(t){e.newParentFileName=t},expression:"newParentFileName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.parentFileDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.createParentFile}},[e._v("确 定")])],1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-row",[a("el-table",{staticClass:"size",staticStyle:{width:"100%","margin-top":"10px"},attrs:{"highlight-current-row":"","show-header":!1,"max-height":"600px","row-style":{height:"0px"},"cell-style":{padding:"0px"},data:e.parentFileList}},[a("el-table-column",{attrs:{prop:"name",label:"文件名",align:"left","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"parentIcon",on:{click:function(a){return e.updateChileFileList(t.row.id,e.pageNum,null,t.row.name)}}},[e._v(e._s(t.row.name))])]}}])}),a("el-table-column",{attrs:{label:"操作",align:"right",width:"60px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",[a("el-col",{attrs:{span:12}},[a("i",{staticClass:"el-icon-edit-outline parentIcon",on:{click:function(a){return e.updateParentFileNameDialogVisible(t.row)}}})]),a("el-col",{attrs:{span:12}},[a("i",{staticClass:"el-icon-delete parentIcon",staticStyle:{"margin-left":"10px"},on:{click:function(a){return e.deleteParentFile(t.row.id)}}})])],1)]}}])})],1),a("el-dialog",{attrs:{title:"重命名数据集",visible:e.parentFileNameDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.parentFileNameDialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入重命名的数据集名称",size:"small"},model:{value:e.newParentFileName,callback:function(t){e.newParentFileName=t},expression:"newParentFileName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.parentFileNameDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.updateParentFileName()}}},[e._v("确 定")])],1)],1)],1)],1)],1)],1),a("el-col",{attrs:{span:20}},[a("el-card",{staticStyle:{height:"calc(100vh - 170px)","margin-top":"10px","margin-left":"10px",overflow:"auto"},attrs:{"body-style":{padding:"0px"}}},[a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:4}},[a("h3",{staticClass:"size",staticStyle:{"margin-left":"5px","margin-top":"3px"}},[a("span",{staticClass:"size",staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 测试模型文件列表 ")])]),a("el-col",{attrs:{span:20}},[e.parentFileName?a("h3",{staticClass:"size"},[e._v(" 当前测试模型: "),a("el-tag",{attrs:{size:"small"}},[e._v(e._s(e.parentFileName))])],1):e._e()])],1),a("el-row",{staticStyle:{"margin-top":"10px","margin-left":"10px","font-size":"20px"}},[a("el-input",{staticStyle:{width:"99%"},attrs:{disabled:"",size:"small"},model:{value:e.dirpath,callback:function(t){e.dirpath=t},expression:"dirpath"}},[a("template",{slot:"prepend"},[e._v("当前路径:")])],2)],1),a("el-row",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-d-arrow-left",size:"small"},on:{click:e.goBack}},[e._v("返回")])],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-folder-add",size:"small"},on:{click:function(t){e.fileDialogVisible=!0}}},[e._v("新建文件夹")])],1),a("el-dialog",{attrs:{title:"新建文件夹",visible:e.fileDialogVisible,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.fileDialogVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入新建的文件名",size:"small"},model:{value:e.newDirName,callback:function(t){e.newDirName=t},expression:"newDirName"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.fileDialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.newDir}},[e._v("确 定")])],1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}}),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-download",size:"small"},on:{click:e.downloadChildFiles}},[e._v("下载选中")])],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-button",{staticStyle:{"margin-top":"10px","margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:e.deleteFiles}},[e._v("删除选中")])],1)],1),a("el-row",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-table",{ref:"table",staticClass:"size",staticStyle:{width:"100%"},attrs:{data:e.childFileList,"max-height":"560"},on:{"select-all":e.selectTableAll,select:e.selectFile}},[a("el-table-column",{attrs:{width:"80",type:"selection"}}),a("el-table-column",{attrs:{prop:"fileName",label:"文件名","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-row",[a("el-col",{attrs:{span:1}},[1==t.row.fileType?a("i",{staticClass:"el-icon-folder"}):e._e(),1!=t.row.fileType?a("i",{staticClass:"el-icon-document"}):e._e()]),a("el-col",{attrs:{span:22,offset:1}},[e.isShow[t.$index]?a("el-input",{directives:[{name:"focus",rawName:"v-focus"}],staticStyle:{"margin-left":"5px"},attrs:{size:"mini",placeholder:t.row.fileName},on:{blur:function(a){return e.updatename(t.$index,t.row)},focus:function(a){e.oldname=t.row.fileName}},model:{value:t.row.fileName,callback:function(a){e.$set(t.row,"fileName",a)},expression:"scope.row.fileName"}}):e._e(),a("span",{directives:[{name:"show",rawName:"v-show",value:!e.isShow[t.$index],expression:"!isShow[scope.$index]"}],staticStyle:{"margin-left":"5px"},on:{click:function(a){return e.openDir(t.row)}}},[e._v(e._s(t.row.fileName))])],1)],1)]}}])}),a("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"modifyTime",label:"修改时间",width:"250"}}),a("el-table-column",{attrs:{prop:"fileSize",label:"大小","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"操作",width:"250","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",icon:"el-icon-edit",size:"small"},on:{click:function(a){return e.changeIsShow(t.$index)}}},[e._v("重命名")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",icon:"el-icon-download",size:"small"},on:{click:function(a){return e.downloadChildFile(t.row.fileName)}}},[e._v("下载")]),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(a){return e.deleteFile(t.row.fileName)}}},[e._v("删除")])]}}])})],1)],1)],1),a("el-col",{staticStyle:{"text-align":"center"}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-pagination",{attrs:{background:!0,"page-sizes":[10,20,30],"page-size":e.page,layout:"prev, pager, next,sizes",total:Number(e.totalRecord)},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1)],1)],1)],1)},Dt=[],Jt={name:"Data",data(){return{page:10,isShow:[],parentId:"",path:[],checkedfile:[],fileDialogVisible:!1,uploadDialogVisible:!1,parentFileDialogVisible:!1,parentFileNameDialogVisible:!1,newDirName:"",oldname:"",parentFileName:"",newParentFileName:"",newParentFileId:""}},directives:{focus:{inserted:function(e){e.querySelector("input").focus()}}},computed:{...(0,Q.rn)("ResultFile",["parentFileList","childFileList","pageNum","filePath","totalRecord"]),dirpath(){let e="";return this.path.forEach((t=>{e=e+"/"+t})),e}},methods:{downloadChildFiles(){for(let e=0;e<this.checkedfile.length;e++)this.downloadChildFile(this.checkedfile[e])},async downloadChildFile(e){let t=await $(e,this.parentId,this.dirpath),a=t.data,s=a.split("/");if("200"==t.code){let e=await E(a);if(1==e.data)window.open("http://202.195.239.146:91/"+s[3]+"/"+s[4]);else{let e=setInterval((async function(){let t=await E(a);1==t.data&&(window.open("http://202.195.239.146:91"+s[0]),clearInterval(e))}),2e4)}}},updateChileFileList(e,t,a,s){this.path=[],this.parentId=e,this.parentFileName=s,this.updateFileList(e,t,a)},updateParentFileNameDialogVisible(e){this.parentFileNameDialogVisible=!0,this.newParentFileName=e.name,this.newParentFileId=e.id},async updateParentFileName(){let e=await F(this.newParentFileId,this.newParentFileName,"",6,2);"200"==e.code?(this.$message({type:"success",message:"更新成功"}),this.parentFileNameDialogVisible=!1,this.updateParentFileList(),this.newParentFileName=""):this.$message.error("更新失败")},async deleteParentFile(e){alert("是否确认删除?");let t=await L(e);"200"==t.code?(this.$message({type:"success",message:"删除成功"}),this.updateParentFileList()):this.$message.error(t.data)},async createParentFile(){let e=await N(this.newParentFileName,"",6,2);"200"==e.code?(this.parentFileDialogVisible=!1,this.$message({type:"success",message:"新建成功"}),this.updateParentFileList(),this.newParentFileName=""):this.$message.error("新建失败")},changeIsShow(e){let t=!this.isShow[e];this.isShow.splice(e,1,t)},initShow(){if(null!=this.childFileList)for(let e=0;e<this.childFileList.length;e++)this.isShow.push(!1)},previewFile(e){let t="http://127.0.0.1:8080/preview"+this.dirpath+"/"+e,s=a(9719).Base64;window.open("http://127.0.0.1:8012/onlinePreview?url="+encodeURIComponent(s.encode(t)))},async deleteFiles(){let e=await D(this.parentId,this.checkedfile,this.dirpath);"200"==e.code&&this.$message({type:"success",message:"删除成功"}),this.updateFileList(this.parentId,this.pageNum,this.dirpath),this.checkedfile=[]},async deleteFile(e){let t=[];t.push(e);let a=await D(this.parentId,t,this.dirpath);"200"==a.code&&this.$message({type:"success",message:"删除成功"}),this.updateFileList(this.parentId,this.pageNum,this.dirpath)},async uploadFile(e){if(e.file.size<2048e3){const t=new FormData;t.append("file",e.file);let a=e.file.size+"-"+e.file.name.substring(0,2)+e.file.name.split(".")[e.file.name.split(".").length-1],s=await J(e.file.size,e.file.size,a,e.file.name,e.file.webkitRelativePath,this.dirpath,this.parentId,e.file);"200"==s.code?this.updateFileList(this.parentId,this.pageNum,this.dirpath):this.$message.error("上传失败")}else this.$message.error("文件过大,无法上传")},submitUpload(){this.$refs.upload.submit()},handleUpload(e){this.uploadDialogVisible=!0,"uploadFile"==e?this.$nextTick((()=>{this.$refs.upload.$children[0].$refs.input.webkitdirectory=!1})):this.$nextTick((()=>{this.$refs.upload.$children[0].$refs.input.webkitdirectory=!0}))},async newDir(){let e=await T(this.parentId,this.dirpath,this.newDirName,null);"200"==e.code?(this.$message({type:"success",message:"新建成功"}),this.updateFileList(this.parentId,this.pageNum,this.dirpath)):this.$message.error("新建失败:文件名重复!"),this.fileDialogVisible=!1,this.newDirName=""},handleClose(e){this.$confirm("确认关闭？").then((t=>{e()})).catch((e=>{}))},selectTableAll(){null!=this.childFileList&&(this.checkedfile.length>=this.childFileList.length?this.checkedfile=[]:(this.checkedfile=[],this.childFileList.forEach((e=>{this.checkedfile.push(e.fileName)}))))},selectFile(e,t){this.checkedfile.includes(t.fileName)?this.checkedfile.forEach((function(e,a,s){e==t.fileName&&s.splice(a,1)})):this.checkedfile.push(t.fileName),null!=this.childFileList&&this.checkedfile.length==this.childFileList.length?this.checkedall=!0:this.checkedall=!1},goBack(){this.path.pop(),this.updateFileList(this.parentId,1,this.dirpath)},openDir(e){1==e.fileType&&(this.path.push(e.fileName),this.updateFileList(this.parentId,1,this.dirpath))},updateFileList(e,t,a){null==e&&this.parentFileList.length>0&&(e=this.parentFileList[0].id,this.ParentFileName=this.parentFileList[0].fileName),this.$store.dispatch("ResultFile/getChildFileList",{dataId:e,filePath:a,current:t,size:this.page}),this.initShow()},async updateParentFileList(){let e=await C(2,0,0);"200"==e.code&&(this.$store.dispatch("ResultFile/getParentFileList",e.data),this.parentFileName=e.data[0].name),null!=this.parentFileList&&this.updateFileList(this.parentFileList[0].id,this.pageNum,null)},async updatename(e,t){if(this.changeIsShow(e),this.oldname!=t.fileName){let e=await z(this.parentId,this.dirpath,this.oldname,t.fileName);"200"==e.code?this.$message({type:"success",message:"修改成功"}):this.$message.error("修改失败")}else this.$message.warning("新名称与原名称相同")},handleCurrentChange(e){this.updateFileList(this.parentId,e,this.dirpath)},handleSizeChange(e){this.page=e,this.updateFileList(this.parentId,this.pageNum,this.dirpath)}},async mounted(){let e=await C(2,0,0);e.data.length>0&&(this.$store.dispatch("ResultFile/getParentFileList",e.data),this.parentFileName=e.data[0].name,"200"==e.code&&e.data.length>0&&this.$store.dispatch("ResultFile/getChildFileList",{dataId:e.data[0].id,filePath:null,current:1,size:this.page}),this.initShow(),this.parentId=e.data[0].id)}},Ot=Jt,Rt=(0,te.Z)(Ot,Et,Dt,!1,null,"17885682",null),Vt=Rt.exports,At=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{staticClass:"size",attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("我的作业")]),a("el-breadcrumb-item",[a("span",{staticClass:"bread",on:{click:e.toJob}},[e._v("作业列表")])]),a("el-breadcrumb-item",[e._v(e._s(e.joblist[e.index].vcJobCnName))])],1)],1),a("el-card",{staticStyle:{"background-color":"#eaebed",margin:"10px",height:"calc(100vh - 170px)"},attrs:{"body-style":{padding:"0px"}}},[a("el-row",[a("el-card",{staticStyle:{height:"85px",margin:"10px"},attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{span:12}},[a("h3",{staticClass:"size",staticStyle:{"margin-left":"5px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 基本信息 ")])]),a("el-row",{staticStyle:{"margin-top":"30px","margin-left":"20px"}},[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"size"},[e._v("作业名称："+e._s(e.joblist[e.index].vcJobCnName))])]),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"size"},[e._v("作业类型：标准作业")])]),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"size"},[e._v("所属队列：default")])])],1)],1)],1),a("el-row",[a("el-card",{staticStyle:{height:"calc(100vh - 290px)","margin-left":"10px","margin-right":"10px","margin-buttom":"10px"},attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[a("el-row",{staticStyle:{"margin-top":"10px"},attrs:{span:12}},[a("h3",{staticClass:"size",staticStyle:{"margin-left":"5px"}},[a("span",{staticStyle:{color:"#409eff"}},[e._v("|")]),e._v(" 计算实例列表 ")])]),a("el-row",{staticStyle:{"margin-top":"10px","margin-left":"20px"}},[a("el-col",{staticStyle:{margin:"10px"},attrs:{span:4}},[a("el-input",{attrs:{size:"small",placeholder:"请输入节点名称","prefix-icon":"el-icon-search"},model:{value:e.hostName,callback:function(t){e.hostName=t},expression:"hostName"}})],1),a("el-col",{staticStyle:{margin:"10px"},attrs:{span:4}},[a("el-input",{attrs:{size:"small","prefix-icon":"el-icon-search",placeholder:"请输入计算实例名称"},model:{value:e.podName,callback:function(t){e.podName=t},expression:"podName"}})],1),a("el-col",{staticStyle:{"margin-top":"10px"},attrs:{span:1}},[a("el-button",{staticClass:"el-icon-search",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.searchList()}}},[e._v("搜索")])],1),a("el-col",{staticStyle:{"margin-left":"10px"},attrs:{span:8}},[e.showHostName?a("el-tag",{staticStyle:{"margin-top":"10px",height:"32px"},attrs:{closable:""},on:{close:e.clearHostSearch}},[e._v("节点:"+e._s(e.hostName))]):e._e(),e.showPodName?a("el-tag",{staticStyle:{"margin-top":"10px",height:"32px","margin-left":"10px"},attrs:{closable:""},on:{close:e.clearPodSearch}},[e._v("计算实例:"+e._s(e.podName))]):e._e()],1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-table",{staticClass:"size",staticStyle:{width:"100%","margin-top":"10px","margin-left":"10px","margin-rigth":"10px"},attrs:{"row-style":{height:"20px"},"cell-style":{padding:"8px"},data:e.formatedJobInfoList,border:!0,"max-height":"360"}},[a("el-table-column",{attrs:{prop:"hostName",label:"节点名称","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"hostIp",label:"节点IP","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"podName",label:"计算实例","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"status",label:"实例状态","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"taskName",label:"所属任务","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"startTime",label:"开始运行时间","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"endTime",label:"运行结束时间","show-overflow-tooltip":""}})],1)],1),a("el-col",{staticStyle:{"text-align":"center"}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-pagination",{attrs:{background:!0,"page-sizes":[10,20,30],"page-size":10,layout:"prev, pager, next,sizes","page-count":Number(e.jobInfoPageCount)},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1)],1)],1)],1)],1)},jt=[],Mt={name:"JobInfo",data(){return{index:0,hostName:"",podName:"",showHostName:!1,showPodName:!1}},computed:{...(0,Q.rn)("Job",["joblist","jobInfoList","jobInfoCurrPageNum","jobInfoPageCount","jobInfoPageSize"]),formatedJobInfoList(){let e=this.jobInfoList;for(let t=0;t<e.length;t++)e[t].startTime=dt(e[t].startTime),e[t].endTime=dt(e[t].endTime),"1970-01-01 08:00:00"==dt(e[t].startTime)&&(e[t].startTime=""),"1970-01-01 08:00:00"==dt(e[t].endTime)&&(e[t].endTime="");return e}},methods:{toJob(){this.$router.push("/job")},searchList(){""!=this.hostName&&(this.showHostName=!0),""!=this.podName&&(this.showPodName=!0),this.search()},clearHostSearch(){this.hostName="",this.showHostName=!1,this.search()},clearPodSearch(){this.podName="",this.showPodName=!1,this.search()},async search(){let e=await A(this.joblist[this.index].clusterId,1,this.hostName,this.jobInfoPageSize,this.podName,this.joblist[this.index].vcJobName);1==e.success&&this.$store.dispatch("Job/getJobInfoList",{currPageNum:e.currPageNum,pageCount:e.pageCount,pageSize:e.pageSize,jobInfoList:e.rows})},async handleCurrentChange(e){let t=await A(this.joblist[this.index].clusterId,e,this.hostName,this.jobInfoPageSize,this.podName,this.joblist[this.index].vcJobName);1==t.success&&this.$store.dispatch("Job/getJobInfoList",{currPageNum:t.currPageNum,pageCount:t.pageCount,pageSize:t.pageSize,jobInfoList:t.rows})},async handleSizeChange(e){let t=await A(this.joblist[this.index].clusterId,1,this.hostName,e,this.podName,this.joblist[this.index].vcJobName);1==t.success&&this.$store.dispatch("Job/getJobInfoList",{currPageNum:t.currPageNum,pageCount:t.pageCount,pageSize:t.pageSize,jobInfoList:t.rows})}},async mounted(){this.index=this.$route.params.index,0==this.joblist.length&&this.$router.push("/job");let e=await A(this.joblist[this.index].clusterId,1,"",10,"",this.joblist[this.index].vcJobName);1==e.success&&this.$store.dispatch("Job/getJobInfoList",{currPageNum:e.currPageNum,pageCount:e.pageCount,pageSize:e.pageSize,jobInfoList:e.rows})}},Ut=Mt,qt=(0,te.Z)(Ut,At,jt,!1,null,"36e34597",null),Bt=qt.exports,Gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{staticClass:"size",attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("在线IDE")]),a("el-breadcrumb-item",[e._v("IDE列表")])],1)],1),a("el-card",{staticClass:"card-style",staticStyle:{height:"calc(100vh - 170px)",overflow:"auto"},attrs:{shadow:"hover","body-style":{padding:"0px"}}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-row",{staticStyle:{"margin-left":"10px",width:"400px"}},[a("el-button-group",[a("el-button",{attrs:{type:1==e.type?"success":"primary",size:"small"},on:{click:function(t){return e.getDataSet(1)}}},[e._v("训练模型")]),a("el-button",{attrs:{type:1!=e.type?"success":"primary",size:"small"},on:{click:function(t){return e.getDataSet(2)}}},[e._v("测试模型")])],1)],1)],1),a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-table",{staticStyle:{"font-size":"16px"},attrs:{data:e.data,"highlight-current-row":"","max-height":"600"}},[a("el-table-column",{attrs:{property:"name",label:1==e.type?"数据集":"结果集"}}),a("el-table-column",{attrs:{property:"catalog",label:"路径"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){return e.openIDE(t.row.catalog)}}},[e._v("打开IDE")])]}}])})],1)],1)],1),a("el-dialog",{staticClass:"dialogClass",attrs:{title:"在线IDE",visible:e.dialogVisible,fullscreen:"","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("iframe",{staticStyle:{width:"100%",height:"calc(100vh - 58px)"},attrs:{name:"iframe",src:"http://202.195.239.146:92/ide/my/?folder=%2Fhome%2Fcoder%2Fworkspace%2F"}})])],1)},Ht=[];const Zt=()=>{var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;expires="+new Date(0).toUTCString()};var Wt={name:"Ide",data(){return{type:1,dialogVisible:!1,name:""}},computed:{...(0,Q.rn)("CreateJob",["data"])},methods:{openIDE(e){this.name=e,b({name:e,password:e});let t=this,a=oe.Loading.service({fullscreen:!0,text:"在线IDE加载中..."});setTimeout((()=>{t.axios({url:"http://202.195.239.146:92/node-manager/user/register",method:"post",data:w().stringify({name:e,password:e})}).then((e=>{}))}),100),setTimeout((()=>{t.axios({url:"http://202.195.239.146:92/node-manager/user/login",method:"post",data:w().stringify({name:e,password:e})}).then((e=>{y()}))}),200),setTimeout((()=>{v()}),900),setTimeout((()=>{a.close(),t.dialogVisible=!0}),3e3)},stopIDE(e){b({name:e,password:e}),_(),this.$message({type:"success",message:"关闭成功!"})},async getDataSet(e){this.type=e;let t=await G(this.type);200==t.code&&this.$store.dispatch("CreateJob/getDataSet",t.data);let a=this;for(let s=0;s<this.data.length;s++)setTimeout((()=>{a.axios({url:"http://202.195.239.146:92/node-manager/user/register",method:"post",data:w().stringify({name:a.data[s].catalog,password:a.data[s].catalog})}).then((e=>{}))}),100*(s+1))},handleClose(e){let t=this;this.$confirm("确认关闭？").then((a=>{e(),Zt(),t.stopIDE(this.name),location.reload()})).catch((e=>{}))}},mounted(){this.getDataSet(this.type)}},Xt=Wt,Kt=(0,te.Z)(Xt,Gt,Ht,!1,null,"725b9141",null),Qt=Kt.exports,Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-breadcrumb",{staticClass:"size",attrs:{separator:"/"}},[a("el-breadcrumb-item",[e._v("个人中心")]),a("el-breadcrumb-item",[e._v("信息管理")])],1)],1),a("el-card",{staticClass:"card-style",staticStyle:{height:"calc(100vh - 170px)",overflow:"auto"},attrs:{shadow:"hover","body-style":{padding:"0px"}}},[a("Transition",{attrs:{appear:"","enter-active-class":"animate__animated animate__fadeInLeft","leave-active-class":"animate__animated animate__fadeOutRight"}},[a("el-form",{ref:"userForm",staticStyle:{margin:"0px",padding:"0px",width:"calc(100vh-250px)"},attrs:{model:e.userInfo,rules:e.userInfoRules}},[a("el-descriptions",{staticClass:"positioncss size",staticStyle:{width:"100%"},attrs:{title:"信息管理",column:2,border:""}},[a("template",{slot:"extra"},[e.edit?e._e():a("el-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(t){e.edit=!0}}},[e._v("编辑")]),a("el-form-item",[e.edit?a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-check"},on:{click:function(t){return e.updateUserInfo()}}},[e._v("保存")]):e._e(),e.edit?a("el-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary",size:"small",icon:"el-icon-close"},on:{click:function(t){return e.cancelUpdate()}}},[e._v("取消")]):e._e()],1)],1),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-info"}),e._v(" 登录账号 ")]),e._v(e._s(e.userInfo.login))],2),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-user"}),e._v(" 用户名")]),e._v(e._s(e.userInfo.name))],2),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-edit"}),e._v(" 密码 ")]),a("span",{staticClass:"passwd",on:{click:function(t){e.passwordDialogVisible=!0}}},[e._v("修改密码")])],2),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-message"}),e._v(" 邮箱 ")]),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:!e.edit,expression:"!edit"}],attrs:{size:"small"}},[e._v(e._s(e.userInfo.email))]),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"}],attrs:{prop:"email"}},[a("el-input",{attrs:{size:"small"},model:{value:e.userInfo.email,callback:function(t){e.$set(e.userInfo,"email",t)},expression:"userInfo.email"}})],1)],2),a("el-descriptions-item",[a("template",{slot:"label"},[a("i",{staticClass:"el-icon-mobile-phone"}),e._v(" 手机 ")]),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:!e.edit,expression:"!edit"}],attrs:{size:"small"}},[e._v(e._s(e.userInfo.phone))]),a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"}],attrs:{prop:"phone"}},[a("el-input",{attrs:{size:"small"},model:{value:e.userInfo.phone,callback:function(t){e.$set(e.userInfo,"phone",t)},expression:"userInfo.phone"}})],1)],2)],2)],1)],1),a("el-dialog",{staticClass:"dialogClass",attrs:{title:"修改密码",visible:e.passwordDialogVisible,width:"400px","before-close":e.handleClose},on:{"update:visible":function(t){e.passwordDialogVisible=t}}},[a("el-form",{ref:"passwdForm",staticStyle:{margin:"0px",padding:"0px"},attrs:{"label-position":"right","label-width":"100px",rules:e.passwdRules,model:e.passwd}},[a("el-col",[a("el-form-item",{attrs:{label:"当前密码",prop:"oldPassword"}},[a("el-input",{staticStyle:{width:"270px"},attrs:{placeholder:"请输入当前密码",size:"small","show-password":""},on:{blur:function(t){return e.verifyPasswd()}},model:{value:e.passwd.oldPassword,callback:function(t){e.$set(e.passwd,"oldPassword",t)},expression:"passwd.oldPassword"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"新密码",prop:"newPassword1"}},[a("el-input",{staticStyle:{width:"270px"},attrs:{"show-password":"",placeholder:"请输入新密码",size:"small"},model:{value:e.passwd.newPassword1,callback:function(t){e.$set(e.passwd,"newPassword1",t)},expression:"passwd.newPassword1"}})],1)],1),a("el-col",[a("el-form-item",{attrs:{label:"二次确认",prop:"newPassword2"}},[a("el-input",{staticStyle:{width:"270px"},attrs:{"show-password":"",placeholder:"请再次输入新密码",size:"small"},model:{value:e.passwd.newPassword2,callback:function(t){e.$set(e.passwd,"newPassword2",t)},expression:"passwd.newPassword2"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){return e.closePasswd()}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.updatePasswd()}}},[e._v("确 定")])],1)],1)],1)],1)},ea=[],ta={name:"UserInfo",data(){var e=(e,t,a)=>""===this.passwd.newPassword2?a(new Error("请再次输入密码")):this.passwd.newPassword2!=this.passwd.newPassword1?a(new Error("两次输入密码不一致!")):a(),t=(e,t,a)=>{const s=/^1[3|4|5|6|7|8][0-9]{9}$/;if(!t)return a(new Error("电话号码不能为空"));setTimeout((()=>{Number.isInteger(+t)?s.test(t)?a():a(new Error("电话号码格式不正确")):a(new Error("请输入数字值"))}),100)};return{edit:!1,passwordDialogVisible:!1,passwd:{oldPassword:"",newPassword1:"",newPassword2:""},passwdRules:{oldPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword1:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:8,max:16,message:"请输入8-16位字符",trigger:"blur"}],newPassword2:[{required:!0,validator:e,trigger:"change"},{min:8,max:16,message:"请输入4-16位字符",trigger:"blur"}]},userInfo:{},userInfoRules:{phone:[{required:!0,validator:t,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]}}},computed:{},methods:{updateUserInfo(){let e=this;this.$refs["userForm"].validate((async t=>{if(!t)return!1;{let t=await K({accountId:JSON.parse(localStorage.getItem("userInfo")).id,dynamicFields:{},email:e.userInfo.email,phone:e.userInfo.phone});"200"==t.code?(e.edit=!1,localStorage.setItem("userInfo",JSON.stringify(e.userInfo)),e.$message({type:"success",message:"修改成功"})):e.$message.error("修改失败")}}))},cancelUpdate(){this.edit=!1,this.userInfo=JSON.parse(localStorage.getItem("userInfo")),this.clearValidate("userForm")},clearValidate(e){this.$refs[e].clearValidate()},async verifyPasswd(){let e=a(9719).Base64;if(""!=this.passwd.oldPassword){let t=await W(e.encode(this.passwd.oldPassword));!0!==t.data&&(this.$message.error("原密码错误!"),this.passwd.oldPassword="")}},handleClose(e){let t=this;this.$confirm("确认关闭？").then((a=>{t.passwd.oldPassword="",t.passwd.newPassword1="",t.passwd.newPassword2="",e()})).catch((e=>{}))},closePasswd(){this.passwordDialogVisible=!1,this.passwd.oldPassword="",this.passwd.newPassword1="",this.passwd.newPassword2=""},updatePasswd(){this.passwordDialogVisible=!1;let e=this;this.$refs["passwdForm"].validate((async t=>{if(!t)return!1;{let t=a(9719).Base64;await X({password:t.encode(this.passwd.newPassword1),oldPassword:t.encode(this.passwd.oldPassword),id:this.userInfo.id});e.logout()}}))}},mounted(){this.userInfo=JSON.parse(localStorage.getItem("userInfo"))}},aa=ta,sa=(0,te.Z)(aa,Yt,ea,!1,null,"10619d1c",null),ia=sa.exports,la=[{name:"login",path:"/login",component:xe,meta:{show:!1}},{name:"userinfo",path:"/userinfo",component:ia,meta:{show:!0,requireAuth:!0}},{name:"standardjob",path:"/standardjob",component:$t,meta:{show:!0,requireAuth:!0}},{name:"ide",path:"/ide",component:Qt,meta:{show:!0,requireAuth:!0}},{name:"jobInfo",path:"/jobinfo/:index",component:Bt,meta:{show:!0,requireAuth:!0}},{name:"job",path:"/job",component:ht,meta:{show:!0,requireAuth:!0}},{name:"images",path:"/images",component:Pt,meta:{show:!0,requireAuth:!0}},{name:"data",path:"/data",component:_t,meta:{show:!0,requireAuth:!0}},{name:"resultdata",path:"/resultdata",component:Vt,meta:{show:!0,requireAuth:!0}},{path:"/*",redirect:"/login"}];s["default"].use(lt.Z);let oa=lt.Z.prototype.push;lt.Z.prototype.push=function(e,t,a){t&&a?oa.call(this,e,t,a):oa.call(this,e,(()=>{}),(()=>{}))};let ra=lt.Z.prototype.Replace;lt.Z.prototype.Replace=function(e,t,a){t&&a?ra.call(this,e,t,a):ra.call(this,e,(()=>{}),(()=>{}))};var na=new lt.Z({routes:la,scrollBehavior(e,t,a){return{y:0}}});s["default"].use(lt.Z),s["default"].use(re()),s["default"].use(ot.Z,c()),s["default"].prototype.$echarts=rt,na.beforeEach(((e,t,a)=>{e.meta.requireAuth&&(localStorage.getItem("token")?a():a({path:"/login",query:{redirect:e.fullPath}})),"login"===e.name&&localStorage.getItem("token")&&a({path:"/job"}),a()})),s["default"].config.productionTip=!1,new s["default"]({render:e=>e(Pe),router:na,store:it,beforeCreate(){s["default"].prototype.$bus=this}}).$mount("#app")},3630:function(e,t,a){"use strict";e.exports=a.p+"img/log.bca7a89a.svg"},7570:function(e,t,a){"use strict";e.exports=a.p+"img/titleicon.6f632fe7.jpg"},4654:function(){}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var l=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=e,function(){a.amdO={}}(),function(){var e=[];a.O=function(t,s,i,l){if(!s){var o=1/0;for(d=0;d<e.length;d++){s=e[d][0],i=e[d][1],l=e[d][2];for(var r=!0,n=0;n<s.length;n++)(!1&l||o>=l)&&Object.keys(a.O).every((function(e){return a.O[e](s[n])}))?s.splice(n--,1):(r=!1,l<o&&(o=l));if(r){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[s,i,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.hmd=function(e){return e=Object.create(e),e.children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e}}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var i,l,o=s[0],r=s[1],n=s[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(i in r)a.o(r,i)&&(a.m[i]=r[i]);if(n)var d=n(a)}for(t&&t(s);c<o.length;c++)l=o[c],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(d)},s=self["webpackChunkCloudPlatform"]=self["webpackChunkCloudPlatform"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(2022)}));s=a.O(s)})();